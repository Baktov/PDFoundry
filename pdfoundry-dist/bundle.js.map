{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/module/api/PDFUtil.ts","src/module/api/PDFoundryAPI.ts","src/module/app/PDFItemSheet.ts","src/module/cache/PDFCache.ts","src/module/events/PDFEvents.ts","src/module/log/PDFLog.ts","src/module/main.ts","src/module/settings/PDFI18n.ts","src/module/settings/PDFSettings.ts","src/module/setup/PDFSetup.ts","src/module/socket/PDFSocketHandler.ts","src/module/socket/events/PDFSetViewEvent.ts","src/module/socket/events/PDFSocketEvent.ts","src/module/viewer/PDFViewer.ts"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFData } from '../types/PDFData';\r\nimport { PDFLog } from '../log/PDFLog';\r\n\r\n/**\r\n * Contains various utility functions for common operations.\r\n */\r\nexport class PDFUtil {\r\n    /**\r\n     * Helper method. Convert a relative URL to a absolute URL\r\n     *  by prepending the window origin to the relative URL.\r\n     * @param dataUrl\r\n     */\r\n    public static getAbsoluteURL(dataUrl: string): string {\r\n        return `${window.origin}/${dataUrl}`;\r\n    }\r\n\r\n    /**\r\n     * Pull relevant data from an item, creating a {@link PDFData}.\r\n     * @param item The item to pull data from.\r\n     */\r\n    public static getPDFDataFromItem(item: Item): PDFData | null {\r\n        if (item === undefined || item === null) {\r\n            return null;\r\n        }\r\n\r\n        const { code, url, offset, cache } = item.data.data;\r\n        const name = item.name;\r\n\r\n        return {\r\n            name,\r\n            code,\r\n            url,\r\n            offset,\r\n            cache,\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Returns true if the URL starts with the origin.\r\n     * @param dataUrl A url.\r\n     */\r\n    public static validateAbsoluteURL(dataUrl: string): boolean {\r\n        return dataUrl.startsWith(window.origin);\r\n    }\r\n\r\n    public static getUserIdsOfRole(role: number) {\r\n        return game.users\r\n            .filter((user) => {\r\n                return user.role === role;\r\n            })\r\n            .map((user) => user.id);\r\n    }\r\n\r\n    public static getUserIdsAtLeastRole(role: number) {\r\n        return game.users\r\n            .filter((user) => {\r\n                return user.role >= role;\r\n            })\r\n            .map((user) => user.id);\r\n    }\r\n\r\n    public static getUserIdsAtMostRole(role: number) {\r\n        return game.users\r\n            .filter((user) => {\r\n                return user.role <= role;\r\n            })\r\n            .map((user) => user.id);\r\n    }\r\n}\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFSettings } from '../settings/PDFSettings';\r\nimport { PDFViewer } from '../viewer/PDFViewer';\r\nimport { PDFCache } from '../cache/PDFCache';\r\nimport { PDFEvents } from '../events/PDFEvents';\r\nimport { PDFUtil } from './PDFUtil';\r\nimport { PDFData } from '../types/PDFData';\r\n\r\ntype ItemComparer = (item: Item) => boolean;\r\n\r\n/**\r\n * The PDFoundry API <br>\r\n * You can access the API with `ui.PDFoundry`\r\n * @module API\r\n */\r\nexport class PDFoundryAPI {\r\n    /**\r\n     * A reference to the static {@link PDFEvents} class.\r\n     */\r\n    public static get events() {\r\n        return PDFEvents;\r\n    }\r\n\r\n    /**\r\n     * A reference to the static {@link PDFUtil} class.\r\n     */\r\n    public static get util() {\r\n        return PDFUtil;\r\n    }\r\n\r\n    // <editor-fold desc=\"GetPDFData Methods\">\r\n\r\n    /**\r\n     * Helper method. Alias for {@link PDFoundryAPI.getPDFData} with a\r\n     *  comparer that searches by PDF Code.\r\n     * @param code Which code to search for a PDF with.\r\n     */\r\n    public static getPDFDataByCode(code: string): PDFData | null {\r\n        return PDFoundryAPI.getPDFData((item) => {\r\n            return item.data.data.code === code;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Helper method. Alias for {@link PDFoundryAPI.getPDFData} with a\r\n     *  comparer that searches by PDF Name.\r\n     * @param name Which name to search for a PDF with.\r\n     * @param caseInsensitive If a case insensitive search should be done.\r\n     */\r\n    public static getPDFDataByName(name: string, caseInsensitive: boolean = true): PDFData | null {\r\n        if (caseInsensitive) {\r\n            return PDFoundryAPI.getPDFData((item) => {\r\n                return item.name.toLowerCase() === name.toLowerCase();\r\n            });\r\n        } else {\r\n            return PDFoundryAPI.getPDFData((item) => {\r\n                return item.name === name;\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Finds a PDF entity created by the user and constructs a\r\n     *  {@link PDFData} object of the resulting PDF's data.\r\n     * @param comparer A comparison function that will be used.\r\n     */\r\n    public static getPDFData(comparer: ItemComparer): PDFData | null {\r\n        const pdf: Item = game.items.find((item: Item) => {\r\n            return item.type === PDFSettings.PDF_ENTITY_TYPE && comparer(item);\r\n        });\r\n\r\n        return PDFUtil.getPDFDataFromItem(pdf);\r\n    }\r\n\r\n    // </editor-fold>\r\n\r\n    // <editor-fold desc=\"OpenPDF Methods\">\r\n\r\n    /**\r\n     * Open the PDF with the provided code to the specified page.\r\n     * Helper for {@link getPDFDataByCode} then {@link openPDF}.\r\n     */\r\n    public static async openPDFByCode(code: string, page: number = 1) {\r\n        const pdf = this.getPDFDataByCode(code);\r\n\r\n        if (pdf === null) {\r\n            const error = game.i18n.localize('PDFOUNDRY.ERROR.NoPDFWithCode');\r\n\r\n            if (PDFSettings.NOTIFICATIONS) {\r\n                ui.notifications.error(error);\r\n            }\r\n\r\n            return Promise.reject(error);\r\n        }\r\n\r\n        return this.openPDF(pdf, page);\r\n    }\r\n\r\n    /**\r\n     * Open the PDF with the provided code to the specified page.\r\n     * Helper for {@link getPDFDataByCode} then {@link openPDF}.\r\n     */\r\n    public static async openPDFByName(name: string, page: number = 1) {\r\n        const pdf = this.getPDFDataByName(name);\r\n\r\n        if (pdf === null) {\r\n            const message = game.i18n.localize('PDFOUNDRY.ERROR.NoPDFWithName');\r\n            const error = new Error(message);\r\n\r\n            if (PDFSettings.NOTIFICATIONS) {\r\n                ui.notifications.error(error.message);\r\n            }\r\n\r\n            return Promise.reject(error);\r\n        }\r\n\r\n        return this.openPDF(pdf, page);\r\n    }\r\n\r\n    /**\r\n     * Open the provided {@link PDFData} to the specified page.\r\n     * @param pdf The PDF to open. See {@link PDFoundryAPI.getPDFData}.\r\n     * @param page The page to open the PDF to.\r\n     */\r\n    public static async openPDF(pdf: PDFData, page: number = 1) {\r\n        let { url, offset, cache } = pdf;\r\n\r\n        if (typeof offset === 'string') {\r\n            offset = parseInt(offset);\r\n        }\r\n\r\n        if (!PDFUtil.validateAbsoluteURL(url)) {\r\n            url = PDFUtil.getAbsoluteURL(url);\r\n        }\r\n\r\n        const viewer = new PDFViewer(pdf);\r\n        viewer.render(true);\r\n\r\n        await PDFoundryAPI._handleOpen(viewer, url, page + offset, cache);\r\n\r\n        return viewer;\r\n    }\r\n\r\n    /**\r\n     * Open a URL as a PDF.\r\n     * @param url The URL to open (must be absolute).\r\n     * @param page Which page to open to. Must be >= 1.\r\n     * @param cache If URL based caching should be used.\r\n     */\r\n    public static async openURL(url: string, page: number = 1, cache: boolean = true): Promise<PDFViewer> {\r\n        if (isNaN(page) || page <= 0) {\r\n            throw new Error(`Page must be > 0, but ${page} was given.`);\r\n        }\r\n\r\n        if (!PDFUtil.validateAbsoluteURL(url)) {\r\n            url = PDFUtil.getAbsoluteURL(url);\r\n        }\r\n\r\n        const viewer = new PDFViewer();\r\n        viewer.render(true);\r\n\r\n        await PDFoundryAPI._handleOpen(viewer, url, page, cache);\r\n\r\n        return viewer;\r\n    }\r\n\r\n    private static async _handleOpen(viewer: PDFViewer, url: string, page: number, cache: boolean) {\r\n        if (cache) {\r\n            const cachedBytes = await PDFCache.getCache(url);\r\n            // If we have a cache hit open the cached data\r\n            if (cachedBytes) {\r\n                await viewer.open(cachedBytes, page);\r\n            } else {\r\n                // Otherwise we should open it by url\r\n                await viewer.open(url, page);\r\n                // And when the download is complete set the cache\r\n                viewer.download().then((bytes) => {\r\n                    PDFCache.setCache(url, bytes);\r\n                });\r\n            }\r\n        } else {\r\n            await viewer.open(url, page);\r\n        }\r\n    }\r\n\r\n    // </editor-fold>\r\n}\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFSettings } from '../settings/PDFSettings';\r\nimport { PDFoundryAPI } from '../api/PDFoundryAPI';\r\nimport { PDFLog } from '../log/PDFLog';\r\n\r\n/**\r\n * Extends the base ItemSheet for linked PDF viewing.\r\n */\r\nexport class PDFItemSheet extends ItemSheet {\r\n    static get defaultOptions() {\r\n        const options = super.defaultOptions;\r\n        options.classes = ['sheet', 'item'];\r\n        options.width = 650;\r\n        options.height = 'auto';\r\n        return options;\r\n    }\r\n\r\n    get template() {\r\n        return `systems/${PDFSettings.EXTERNAL_SYSTEM_NAME}/${PDFSettings.DIST_FOLDER}/templates/sheet/pdf-sheet.html`;\r\n    }\r\n\r\n    /**\r\n     * Helper method to get a id in the html form\r\n     * html ids are prepended with the id of the item to preserve uniqueness\r\n     *  which is mandatory to allow multiple forms to be open\r\n     * @param html\r\n     * @param id\r\n     */\r\n    private _getByID(html: JQuery<HTMLElement>, id: string): JQuery<HTMLElement> {\r\n        return html.parent().parent().find(`#${this.item._id}-${id}`);\r\n    }\r\n\r\n    protected _getHeaderButtons(): any[] {\r\n        const buttons = super._getHeaderButtons();\r\n        buttons.unshift({\r\n            class: 'pdf-sheet-manual',\r\n            icon: 'fas fa-question-circle',\r\n            label: 'Help',\r\n            onclick: () => PDFSettings.showHelp(),\r\n        });\r\n        //TODO: Standardize this to function w/ the Viewer one\r\n        buttons.unshift({\r\n            class: 'pdf-sheet-github',\r\n            icon: 'fas fa-external-link-alt',\r\n            label: 'PDFoundry',\r\n            onclick: () => window.open('https://github.com/Djphoenix719/PDFoundry', '_blank'),\r\n        });\r\n        return buttons;\r\n    }\r\n\r\n    protected activateListeners(html: JQuery<HTMLElement>): void {\r\n        super.activateListeners(html);\r\n\r\n        const urlInput = this._getByID(html, 'data\\\\.url');\r\n        const offsetInput = this._getByID(html, 'data\\\\.offset');\r\n\r\n        // Block enter from displaying the PDF\r\n        html.find('input').on('keypress', function (event) {\r\n            if (event.key === 'Enter') {\r\n                event.preventDefault();\r\n            }\r\n        });\r\n\r\n        // Test button\r\n        this._getByID(html, 'pdf-test').on('click', function (event) {\r\n            event.preventDefault();\r\n\r\n            let urlValue = urlInput.val();\r\n            let offsetValue = offsetInput.val();\r\n\r\n            if (urlValue === null || urlValue === undefined) return;\r\n            if (offsetValue === null || offsetValue === undefined) return;\r\n\r\n            urlValue = `${window.location.origin}/${urlValue}`;\r\n\r\n            if (offsetValue.toString().trim() === '') {\r\n                offsetValue = 0;\r\n            }\r\n            offsetValue = parseInt(offsetValue as string);\r\n\r\n            PDFoundryAPI.openURL(urlValue, 5 + offsetValue, false);\r\n        });\r\n\r\n        // Browse button\r\n        this._getByID(html, 'pdf-browse').on('click', async function (event) {\r\n            event.preventDefault();\r\n\r\n            const fp = new FilePicker({});\r\n            // @ts-ignore TODO: foundry-pc-types\r\n            fp.extensions = ['.pdf'];\r\n            fp.field = urlInput[0];\r\n\r\n            let urlValue = urlInput.val();\r\n            if (urlValue !== undefined) {\r\n                await fp.browse(urlValue.toString().trim());\r\n            }\r\n\r\n            fp.render(true);\r\n        });\r\n    }\r\n}\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nimport { PDFViewer } from '../viewer/PDFViewer';\r\nimport { PDFSettings } from '../settings/PDFSettings';\r\nimport { PDFLog } from '../log/PDFLog';\r\n\r\n/**\r\n * Error that occurs during IDB operations\r\n */\r\nexport class IDBHelperError extends Error {\r\n    constructor(index: string, store: string, message?: string) {\r\n        super(`Error in ${index}>${store}: ${message}`);\r\n    }\r\n}\r\n\r\n/**\r\n * Class that deals with getting/setting from an indexed db\r\n * Mostly exists to separate logic for the PDFCache from logic\r\n *  dealing with the database\r\n */\r\nclass IDBHelper {\r\n    private _version: number;\r\n\r\n    private readonly _indexName: string;\r\n    private readonly _storeNames: string[];\r\n\r\n    private _db: IDBDatabase;\r\n\r\n    public static async createAndOpen(indexName: string, storeNames: string[], version: number) {\r\n        const helper = new IDBHelper(indexName, storeNames, version);\r\n        await helper.open();\r\n        return helper;\r\n    }\r\n\r\n    public get ready() {\r\n        return this._db !== undefined;\r\n    }\r\n\r\n    public constructor(indexName: string, storeNames: string[], version: number) {\r\n        this._indexName = `${indexName}`;\r\n        this._storeNames = storeNames;\r\n        this._version = version;\r\n    }\r\n\r\n    private newTransaction(storeName: string) {\r\n        const transaction = this._db.transaction(storeName, 'readwrite');\r\n        const store = transaction.objectStore(storeName);\r\n        return { transaction, store };\r\n    }\r\n\r\n    public open(): Promise<void> {\r\n        const that = this;\r\n        return new Promise<void>(function (resolve, reject) {\r\n            const request = indexedDB.open(that._indexName, that._version);\r\n            request.onsuccess = function (event) {\r\n                that._db = this.result;\r\n                resolve();\r\n            };\r\n            request.onupgradeneeded = function (event) {\r\n                that._db = this.result;\r\n                for (let i = 0; i < that._storeNames.length; i++) {\r\n                    try {\r\n                        // Create object store if it doesn't exist\r\n                        that._db.createObjectStore(that._storeNames[i], {});\r\n                    } catch (error) {\r\n                        // Otherwise pass\r\n                    }\r\n                }\r\n                resolve();\r\n            };\r\n            request.onerror = function (event) {\r\n                // @ts-ignore\r\n                reject(event.target.error);\r\n            };\r\n        });\r\n    }\r\n\r\n    public set(key: IDBValidKey, value: any, storeName: string, force: boolean = false): Promise<void> {\r\n        return new Promise<void>((resolve, reject) => {\r\n            if (!this._db) {\r\n                throw new IDBHelperError(this._indexName, storeName, 'Database is not initialized.');\r\n            } else {\r\n                const that = this;\r\n                let { transaction, store } = this.newTransaction(storeName);\r\n\r\n                // Propagate errors upwards, otherwise they fail silently\r\n                transaction.onerror = function (event) {\r\n                    // @ts-ignore\r\n                    reject(event.target.error);\r\n                };\r\n\r\n                const keyRequest = store.getKey(key);\r\n                keyRequest.onsuccess = function (event) {\r\n                    // key already exists in the store\r\n                    if (keyRequest.result) {\r\n                        // should we force the new value by deleting the old?\r\n                        if (force) {\r\n                            that.del(key, storeName).then(() => {\r\n                                ({ transaction, store } = that.newTransaction(storeName));\r\n                                store.add(value, key);\r\n                                resolve();\r\n                            });\r\n                        } else {\r\n                            throw new IDBHelperError(that._indexName, storeName, `Key ${key} already exists.`);\r\n                        }\r\n                    } else {\r\n                        store.add(value, key);\r\n                        resolve();\r\n                    }\r\n                };\r\n            }\r\n        });\r\n    }\r\n\r\n    public get(key: IDBValidKey, storeName: string): Promise<any> {\r\n        return new Promise<void>((resolve, reject) => {\r\n            if (!this._db) {\r\n                throw new IDBHelperError(this._indexName, storeName, 'Database is not initialized.');\r\n            } else {\r\n                let { transaction, store } = this.newTransaction(storeName);\r\n\r\n                // Propagate errors upwards, otherwise they fail silently\r\n                transaction.onerror = function (event) {\r\n                    // @ts-ignore\r\n                    reject(event.target.error);\r\n                };\r\n\r\n                const getRequest = store.get(key);\r\n                getRequest.onsuccess = function (event) {\r\n                    resolve(this.result);\r\n                };\r\n\r\n                getRequest.onerror = function (event) {\r\n                    // @ts-ignore\r\n                    reject(event.target.error);\r\n                };\r\n            }\r\n        });\r\n    }\r\n\r\n    public del(key: IDBValidKey, storeName: string): Promise<void> {\r\n        return new Promise<void>((resolve, reject) => {\r\n            try {\r\n                const { transaction, store } = this.newTransaction(storeName);\r\n\r\n                transaction.onerror = function (event) {\r\n                    // @ts-ignore\r\n                    reject(event.target.error);\r\n                };\r\n                transaction.oncomplete = function (event) {\r\n                    resolve();\r\n                };\r\n\r\n                store.delete(key);\r\n            } catch (error) {\r\n                reject(error);\r\n            }\r\n        });\r\n    }\r\n\r\n    public keys(storeName: string): Promise<IDBValidKey[]> {\r\n        return new Promise<IDBValidKey[]>((resolve, reject) => {\r\n            try {\r\n                const { transaction, store } = this.newTransaction(storeName);\r\n                const keysRequest = store.getAllKeys();\r\n\r\n                keysRequest.onsuccess = function () {\r\n                    resolve(keysRequest.result);\r\n                };\r\n                keysRequest.onerror = function (event) {\r\n                    // @ts-ignore\r\n                    reject(event.target.error);\r\n                };\r\n\r\n                return;\r\n            } catch (error) {\r\n                reject(error);\r\n            }\r\n        });\r\n    }\r\n\r\n    public clr(storeName: string): Promise<void> {\r\n        return new Promise<void>((resolve, reject) => {\r\n            try {\r\n                const { store } = this.newTransaction(storeName);\r\n                const keys = store.getAllKeys();\r\n                keys.onsuccess = (result) => {\r\n                    const promises: Promise<void>[] = [];\r\n                    for (const key of keys.result) {\r\n                        promises.push(this.del(key, storeName));\r\n                    }\r\n                    Promise.all(promises).then(() => {\r\n                        resolve();\r\n                    });\r\n                };\r\n            } catch (error) {\r\n                reject(error);\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Meta information about a cache entry\r\n */\r\ntype CacheMeta = {\r\n    size: number;\r\n    dateAccessed: string;\r\n};\r\n\r\n/**\r\n * Handles caching for PDFs\r\n */\r\nexport class PDFCache {\r\n    // <editor-fold desc=\"Static Properties\">\r\n    /**\r\n     * Max size of the cache, defaults to 256 MB.\r\n     */\r\n    public static get MAX_BYTES() {\r\n        return game.settings.get(PDFSettings.EXTERNAL_SYSTEM_NAME, 'CacheSize');\r\n    }\r\n\r\n    private static readonly IDB_NAME: string = 'PDFoundry';\r\n    private static readonly IDB_VERSION: number = 1;\r\n\r\n    private static readonly CACHE: string = `Cache`;\r\n    private static readonly META: string = `Meta`;\r\n\r\n    private static _cacheHelper: IDBHelper;\r\n    // </editor-fold>\r\n\r\n    public static async initialize() {\r\n        PDFCache._cacheHelper = await IDBHelper.createAndOpen(PDFCache.IDB_NAME, [PDFCache.CACHE, PDFCache.META], PDFCache.IDB_VERSION);\r\n    }\r\n\r\n    public static async getMeta(key: string): Promise<CacheMeta | null> {\r\n        try {\r\n            return await PDFCache._cacheHelper.get(key, PDFCache.META);\r\n        } catch (error) {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    public static async setMeta(key: string, meta: CacheMeta): Promise<void> {\r\n        await PDFCache._cacheHelper.set(key, meta, PDFCache.META, true);\r\n    }\r\n\r\n    public static async getCache(key: string): Promise<Uint8Array | null> {\r\n        try {\r\n            const bytes = await PDFCache._cacheHelper.get(key, PDFCache.CACHE);\r\n            const meta: CacheMeta = {\r\n                dateAccessed: new Date().toISOString(),\r\n                size: bytes.length,\r\n            };\r\n            await PDFCache.setMeta(key, meta);\r\n\r\n            return bytes;\r\n        } catch (error) {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    public static async setCache(key: string, bytes: Uint8Array) {\r\n        PDFLog.warn(`Cached data for ${key}`);\r\n        const meta: CacheMeta = {\r\n            dateAccessed: new Date().toISOString(),\r\n            size: bytes.length,\r\n        };\r\n\r\n        await PDFCache._cacheHelper.set(key, bytes, PDFCache.CACHE, true);\r\n        await PDFCache.setMeta(key, meta);\r\n        await this.prune();\r\n    }\r\n\r\n    private static async prune() {\r\n        const keys = await this._cacheHelper.keys(PDFCache.META);\r\n\r\n        let totalBytes = 0;\r\n        let metas: any[] = [];\r\n        for (const key of keys) {\r\n            const meta = await this._cacheHelper.get(key, PDFCache.META);\r\n            meta.dateAccessed = Date.parse(meta.dateAccessed);\r\n            meta.size = parseInt(meta.size);\r\n\r\n            totalBytes += meta.size;\r\n\r\n            metas.push({\r\n                key,\r\n                meta,\r\n            });\r\n        }\r\n\r\n        metas = metas.sort((a, b) => {\r\n            return a.meta.dateAccessed - b.meta.dateAccessed;\r\n        });\r\n\r\n        for (let i = 0; i < metas.length; i++) {\r\n            if (totalBytes < PDFCache.MAX_BYTES) {\r\n                break;\r\n            }\r\n\r\n            const next = metas[i];\r\n\r\n            await this._cacheHelper.del(next.key, PDFCache.META);\r\n            await this._cacheHelper.del(next.key, PDFCache.CACHE);\r\n\r\n            totalBytes -= next.meta.size;\r\n\r\n            PDFLog.warn(`Pruned ${next.meta.size} bytes by deleting ${next.key}`);\r\n        }\r\n    }\r\n\r\n    public static registerSettings() {\r\n        game.settings.register(PDFSettings.EXTERNAL_SYSTEM_NAME, 'CacheSize', {\r\n            name: game.i18n.localize('PDFOUNDRY.SETTINGS.CacheSizeName'),\r\n            scope: 'user',\r\n            type: Number,\r\n            hint: game.i18n.localize('PDFOUNDRY.SETTINGS.CacheSizeHint'),\r\n            default: 256 * 2 ** 20, // 256 MB\r\n            config: true,\r\n        });\r\n    }\r\n}\r\n\r\n// public static getOrFetch(key: string): Promise<Uint8Array | null> {\r\n//     return new Promise<Uint8Array>(async (resolve, reject) => {\r\n//         const cachedBytes = await PDFCache.getCache(key);\r\n//         if (cachedBytes !== null && cachedBytes.byteLength > 0) {\r\n//             resolve(cachedBytes);\r\n//             return;\r\n//         }\r\n//\r\n//         const response = await fetch(key);\r\n//         if (response.ok) {\r\n//             const fetchedBytes = new Uint8Array(await response.arrayBuffer());\r\n//             if (fetchedBytes.byteLength > 0) {\r\n//                 await PDFCache.setCache(key, fetchedBytes);\r\n//                 resolve(fetchedBytes);\r\n//                 return;\r\n//             } else {\r\n//                 reject('Cache & fetch both failed.');\r\n//             }\r\n//         } else {\r\n//             reject('Cache & fetch both failed.');\r\n//         }\r\n//     });\r\n// }\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFLog } from '../log/PDFLog';\r\n\r\ntype PDFSetupEvent = 'init' | 'setup' | 'ready';\r\n\r\ntype PDFViewerEvent = 'viewerOpen' | 'viewerClose' | 'viewerReady';\r\n\r\nexport type PDFEvent = PDFSetupEvent | PDFViewerEvent;\r\n\r\n/**\r\n * @private\r\n */\r\nclass EventStore {\r\n    private readonly _name: PDFEvent;\r\n    private readonly _callbacks: Function[];\r\n\r\n    constructor(name: PDFEvent) {\r\n        this._name = name;\r\n        this._callbacks = [];\r\n    }\r\n\r\n    /**\r\n     * Turn on an event callback for this event.\r\n     * @param callback The callback to turn on\r\n     */\r\n    public on(callback: Function) {\r\n        if (this._callbacks === undefined) {\r\n            return;\r\n        }\r\n\r\n        for (let i = 0; i < this._callbacks.length; i++) {\r\n            if (this._callbacks[i] === callback) return;\r\n        }\r\n\r\n        this._callbacks.push(callback);\r\n    }\r\n\r\n    /**\r\n     * Turn off an event callback for this event.\r\n     * @param callback The callback to turn off\r\n     */\r\n    public off(callback: Function) {\r\n        if (this._callbacks === undefined) {\r\n            return;\r\n        }\r\n\r\n        for (let i = this._callbacks.length; i >= 0; i--) {\r\n            if (this._callbacks[i] === callback) {\r\n                this._callbacks.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Fire an event and forward the args to all handlers\r\n     * @param args Any arguments that should be passed to handlers\r\n     */\r\n    public fire(...args) {\r\n        if (PDFEvents.DEBUG) {\r\n            PDFLog.log(`<${this._name}>`);\r\n            console.log(args);\r\n        }\r\n\r\n        for (const cb of this._callbacks) {\r\n            cb(...args);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Tracks and publishes events for PDF related occurrences.\r\n * This class is callable through `ui.PDFoundry.events`\r\n */\r\nexport class PDFEvents {\r\n    /**\r\n     * Should every event call's event name and arguments be logged?\r\n     */\r\n    public static DEBUG: boolean = true;\r\n\r\n    private static _EVENTS = {\r\n        init: new EventStore('init'),\r\n        setup: new EventStore('setup'),\r\n        ready: new EventStore('ready'),\r\n\r\n        viewerOpen: new EventStore('viewerOpen'),\r\n        viewerClose: new EventStore('viewerClose'),\r\n        viewerReady: new EventStore('viewerReady'),\r\n    };\r\n\r\n    // <editor-fold desc=\"Setup & Initialization Events\">\r\n\r\n    /**\r\n     * Helper method version of {@link PDFEvents.on}\r\n     * Called when all PDFoundry init stage events are done.\r\n     */\r\n    public static get init() {\r\n        return PDFEvents._EVENTS['init'].on;\r\n    }\r\n\r\n    /**\r\n     * Helper method version of {@link PDFEvents.on}\r\n     * Called when all PDFoundry setup stage events are done.\r\n     */\r\n    public static get setup() {\r\n        return PDFEvents._EVENTS['setup'].on;\r\n    }\r\n\r\n    /**\r\n     * Helper method version of {@link PDFEvents.on}\r\n     * Called when all PDFoundry ready stage events are done.\r\n     */\r\n    public static get ready() {\r\n        return PDFEvents._EVENTS['ready'].on;\r\n    }\r\n\r\n    // </editor-fold>\r\n\r\n    // <editor-fold desc=\"Viewer Events\">\r\n\r\n    /**\r\n     * Helper method version of {@link PDFEvents.on}\r\n     * Called when a PDF viewer begins opening\r\n     */\r\n    public static get viewerOpen() {\r\n        return PDFEvents._EVENTS['viewerOpen'].on;\r\n    }\r\n\r\n    /**\r\n     * Helper method version of {@link PDFEvents.on}\r\n     * Called when a PDF viewer begins closing\r\n     */\r\n    public static get viewerClose() {\r\n        return PDFEvents._EVENTS['viewerClose'].on;\r\n    }\r\n\r\n    /**\r\n     * Helper method version of {@link PDFEvents.on}\r\n     * Called when a PDF viewer is ready to use\r\n     */\r\n    public static get viewerReady() {\r\n        return PDFEvents._EVENTS['viewerReady'].on;\r\n    }\r\n\r\n    // </editor-fold>\r\n\r\n    /**\r\n     * Like @see {@link PDFEvents.on} but fires the event only once, then calls off.\r\n     * @param event\r\n     * @param callback\r\n     */\r\n    public static once(event: PDFEvent, callback: Function) {\r\n        const wrapper = function (...args) {\r\n            callback(args);\r\n            PDFEvents.off(event, wrapper);\r\n        };\r\n        PDFEvents.on(event, wrapper);\r\n    }\r\n\r\n    /**\r\n     * Turn on an event callback for an event.\r\n     * @param event The name of the event\r\n     * @param callback The callback to turn on\r\n     */\r\n    public static on(event: PDFEvent, callback: Function) {\r\n        PDFEvents._EVENTS[event].on(callback);\r\n    }\r\n\r\n    /**\r\n     * Turn off an event callback for an event.\r\n     * @param event The name of the event\r\n     * @param callback The callback to turn off\r\n     */\r\n    public static off(event: PDFEvent, callback: Function) {\r\n        PDFEvents._EVENTS[event].off(callback);\r\n    }\r\n\r\n    public static fire(event: PDFEvent, ...args) {\r\n        if (PDFEvents.DEBUG) {\r\n            PDFLog.verbose(`Firing Event: ${event}`);\r\n            console.debug(args);\r\n        }\r\n        PDFEvents._EVENTS[event].fire(args);\r\n    }\r\n}\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\ntype ConsoleMessage = object | string | number | null;\r\ntype LogType = 'log' | 'warn' | 'error' | 'verbose';\r\n\r\n/**\r\n * A console logging wrapper that includes some additional information\r\n *  with output to help filter messages easier.\r\n */\r\nexport class PDFLog {\r\n    public static readonly PREFIX: string = 'PDFoundry';\r\n\r\n    private static format(message: ConsoleMessage) {\r\n        const time = new Date();\r\n\r\n        const pad = (n: number) => {\r\n            return n >= 10 ? n : `0${n}`;\r\n        };\r\n        const pad_ms = (n: number) => {\r\n            const s = n.toString();\r\n            return '0000'.substring(0, 4 - s.length) + s;\r\n        };\r\n\r\n        const hh = pad(time.getHours());\r\n        const mm = pad(time.getMinutes());\r\n        const ss = pad(time.getSeconds());\r\n        const ms = pad_ms(time.getMilliseconds());\r\n\r\n        return `[${PDFLog.PREFIX}@${hh}:${mm}:${ss}.${ms}] ${message}`;\r\n    }\r\n\r\n    /**\r\n     * Snapshot an object to preserve it's CURRENT state in console\r\n     * Otherwise consoles 'lazy load' objects, and it is very hard\r\n     *  to inspect their values when they were printed (sans breakpoints)\r\n     * @param value The object to snapshot\r\n     * @param level What logging level should be used\r\n     */\r\n    public static snapshot(value: object, level: LogType = 'log') {\r\n        const snap = JSON.parse(JSON.stringify(value));\r\n        let fn: Function;\r\n\r\n        switch (level) {\r\n            case 'log':\r\n                fn = console.log;\r\n                break;\r\n            case 'warn':\r\n                fn = console.warn;\r\n                break;\r\n            case 'error':\r\n                fn = console.error;\r\n                break;\r\n            case 'verbose':\r\n                fn = console.debug;\r\n                break;\r\n        }\r\n\r\n        fn(PDFLog.format(':: Frozen Object ::'));\r\n        fn(snap);\r\n    }\r\n\r\n    /**\r\n     * Print a log level message to console.\r\n     * @param message The message to print.\r\n     */\r\n    public static log(message: ConsoleMessage) {\r\n        if (typeof message === 'string' || typeof message === 'number') {\r\n            console.log(PDFLog.format(message));\r\n        } else {\r\n            console.log(PDFLog.format(':: Live Object ::'));\r\n            console.log(message);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Print an info level message to console.\r\n     * @param message The message to print.\r\n     */\r\n    public static info(message: ConsoleMessage) {\r\n        if (typeof message === 'string' || typeof message === 'number') {\r\n            console.info(PDFLog.format(message));\r\n        } else {\r\n            console.info(PDFLog.format(':: Live Object ::'));\r\n            console.info(message);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Print a verbose level message to console.\r\n     * @param message The message to print.\r\n     */\r\n    public static verbose(message: ConsoleMessage) {\r\n        if (typeof message === 'string' || typeof message === 'number') {\r\n            console.debug(PDFLog.format(message));\r\n        } else {\r\n            console.debug(PDFLog.format(':: Live Object ::'));\r\n            console.debug(message);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Print a warning level message to console.\r\n     * @param message The message to print.\r\n     */\r\n    public static warn(message: ConsoleMessage) {\r\n        if (typeof message === 'string' || typeof message === 'number') {\r\n            console.warn(PDFLog.format(message));\r\n        } else {\r\n            console.warn(PDFLog.format(':: Live Object ::'));\r\n            console.warn(message);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Print a error level message to console.\r\n     * @param message The message to print.\r\n     */\r\n    public static error(message: ConsoleMessage) {\r\n        if (typeof message === 'string' || typeof message === 'number') {\r\n            console.error(PDFLog.format(message));\r\n        } else {\r\n            console.error(PDFLog.format(':: Live Object ::'));\r\n            console.error(message);\r\n        }\r\n    }\r\n}\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFSetup } from './setup/PDFSetup';\r\nimport { PDFCache } from './cache/PDFCache';\r\nimport { PDFEvents } from './events/PDFEvents';\r\nimport { PDFI18n } from './settings/PDFI18n';\r\nimport { PDFSettings } from './settings/PDFSettings';\r\nimport { PDFLog } from './log/PDFLog';\r\nimport { PDFSetViewEvent } from './socket/events/PDFSetViewEvent';\r\nimport { PDFSocketHandler } from './socket/PDFSocketHandler';\r\n\r\nCONFIG.debug.hooks = true;\r\n\r\nPDFSetup.registerSystem();\r\n\r\nconst init = async () => {\r\n    // Register the API on the ui object\r\n    PDFSetup.registerAPI();\r\n    // Inject the css into the page\r\n    PDFSetup.registerCSS();\r\n\r\n    PDFEvents.fire('init');\r\n\r\n    await setup();\r\n};\r\nconst setup = async () => {\r\n    // Initialize the cache system, creating the DB\r\n    await PDFCache.initialize();\r\n    // Load the relevant internationalization file.\r\n    await PDFI18n.initialize();\r\n\r\n    PDFEvents.fire('setup');\r\n\r\n    await ready();\r\n};\r\nconst ready = async () => {\r\n    // Register the PDF sheet with the class picker, unregister others\r\n    PDFSetup.registerPDFSheet();\r\n    // Initialize the settings\r\n    await PDFSettings.registerSettings();\r\n\r\n    PDFSetup.userLogin();\r\n\r\n    PDFSocketHandler.registerHandlers();\r\n\r\n    PDFEvents.fire('ready');\r\n};\r\n\r\nHooks.once('init', init);\r\n\r\n// <editor-fold desc=\"Persistent Hooks\">\r\n\r\n// preCreateItem - Setup default values for a new PDFoundry_PDF\r\nHooks.on('preCreateItem', PDFSettings.preCreateItem);\r\n// getItemDirectoryEntryContext - Setup context menu for 'Open PDF' links\r\nHooks.on('getItemDirectoryEntryContext', PDFSettings.getItemContextOptions);\r\n// renderSettings - Inject a 'Open Manual' button into help section\r\nHooks.on('renderSettings', PDFSettings.onRenderSettings);\r\n\r\n// </editor-fold>\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFSettings } from './PDFSettings';\r\n\r\n/**\r\n * Localization helper\r\n */\r\nexport class PDFI18n {\r\n    /**\r\n     * Load the localization file for the user's language.\r\n     */\r\n    public static async initialize() {\r\n        const lang = game.i18n.lang;\r\n        // user's language path\r\n        const u_path = `systems/${PDFSettings.EXTERNAL_SYSTEM_NAME}/${PDFSettings.DIST_FOLDER}/locale/${lang}/config.json`;\r\n        // english fallback path\r\n        const f_path = `systems/${PDFSettings.EXTERNAL_SYSTEM_NAME}/${PDFSettings.DIST_FOLDER}/locale/en/config.json`;\r\n\r\n        let json;\r\n        try {\r\n            json = await $.getJSON(u_path);\r\n        } catch (error) {\r\n            // if no translation exits for the users locale the fallback\r\n            json = await $.getJSON(f_path);\r\n        }\r\n\r\n        for (const key of Object.keys(json)) {\r\n            game.i18n.translations[key] = json[key];\r\n        }\r\n\r\n        // setup the fallback as english so partial translations do not display keys\r\n        let fb_json = await $.getJSON(f_path);\r\n        for (const key of Object.keys(fb_json)) {\r\n            // @ts-ignore\r\n            game.i18n._fallback[key] = json[key];\r\n        }\r\n    }\r\n}\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFItemSheet } from '../app/PDFItemSheet';\r\nimport { PDFoundryAPI } from '../api/PDFoundryAPI';\r\nimport { PDFLog } from '../log/PDFLog';\r\nimport { PDFCache } from '../cache/PDFCache';\r\nimport { PDFUtil } from '../api/PDFUtil';\r\n\r\n/**\r\n * Internal settings and helper methods for PDFoundry.\r\n */\r\nexport class PDFSettings {\r\n    /**\r\n     * Are feedback notifications enabled? Disable if you wish\r\n     *  to handle them yourself.\r\n     */\r\n    public static NOTIFICATIONS: boolean = true;\r\n\r\n    public static DIST_FOLDER: string = 'pdfoundry-dist';\r\n    public static EXTERNAL_SYSTEM_NAME: string = '../modules/pdfoundry';\r\n    public static INTERNAL_MODULE_NAME: string = 'pdfoundry';\r\n    public static PDF_ENTITY_TYPE: string = 'PDFoundry_PDF';\r\n\r\n    public static HELP_SEEN_KEY: string = 'HelpSeen';\r\n\r\n    /**\r\n     * Setup default values for pdf entities\r\n     * @param entity\r\n     * @param args ignored args\r\n     */\r\n    public static async preCreateItem(entity, ...args) {\r\n        PDFLog.verbose('Pre-create item.');\r\n        if (entity.type !== PDFSettings.PDF_ENTITY_TYPE) {\r\n            return;\r\n        }\r\n        entity.img = `systems/${PDFSettings.EXTERNAL_SYSTEM_NAME}/${PDFSettings.DIST_FOLDER}/assets/pdf_icon.svg`;\r\n    }\r\n\r\n    /**\r\n     * Helper method to grab the id from the html object and return an item\r\n     * @param html\r\n     */\r\n    private static getItemFromContext(html: JQuery<HTMLElement>): Item {\r\n        const id = html.data('entity-id');\r\n        return game.items.get(id);\r\n    }\r\n\r\n    /**\r\n     * Get additional context menu icons for PDF items\r\n     * @param html\r\n     * @param options\r\n     */\r\n    public static getItemContextOptions(html, options: any[]) {\r\n        PDFLog.verbose('Getting context options.');\r\n        options.unshift({\r\n            name: game.i18n.localize('PDFOUNDRY.CONTEXT.OpenPDF'),\r\n            icon: '<i class=\"far fa-file-pdf\"></i>',\r\n            condition: (entityHtml: JQuery<HTMLElement>) => {\r\n                const item = PDFSettings.getItemFromContext(entityHtml);\r\n                if (item.type !== PDFSettings.PDF_ENTITY_TYPE) {\r\n                    return false;\r\n                }\r\n\r\n                const { url } = item.data.data;\r\n                return url !== '';\r\n            },\r\n            callback: (entityHtml: JQuery<HTMLElement>) => {\r\n                const item = PDFSettings.getItemFromContext(entityHtml);\r\n                const pdf = PDFUtil.getPDFDataFromItem(item);\r\n\r\n                if (pdf === null) {\r\n                    //TODO: Error handling\r\n                    return;\r\n                }\r\n\r\n                PDFoundryAPI.openPDF(pdf, 1);\r\n            },\r\n        });\r\n    }\r\n\r\n    public static registerSettings() {\r\n        PDFCache.registerSettings();\r\n    }\r\n\r\n    public static onRenderSettings(settings: any, html: JQuery<HTMLElement>, data: any) {\r\n        PDFLog.verbose('Rendering settings.');\r\n        const icon = '<i class=\"far fa-file-pdf\"></i>';\r\n        const button = $(`<button>${icon} ${game.i18n.localize('PDFOUNDRY.SETTINGS.OpenHelp')}</button>`);\r\n        button.on('click', PDFSettings.showHelp);\r\n\r\n        html.find('h2').last().before(button);\r\n    }\r\n\r\n    public static async showHelp() {\r\n        await game.user.setFlag(PDFSettings.INTERNAL_MODULE_NAME, PDFSettings.HELP_SEEN_KEY, true);\r\n\r\n        return PDFoundryAPI.openURL(\r\n            `${window.origin}/systems/${PDFSettings.EXTERNAL_SYSTEM_NAME}/${PDFSettings.DIST_FOLDER}/assets/PDFoundry Manual.pdf`,\r\n            1,\r\n            false,\r\n        );\r\n    }\r\n}\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFSettings } from '../settings/PDFSettings';\r\nimport { PDFItemSheet } from '../app/PDFItemSheet';\r\nimport { PDFoundryAPI } from '../api/PDFoundryAPI';\r\nimport { PDFLog } from '../log/PDFLog';\r\n\r\n/**\r\n * A collection of methods used for setting up the API & system state.\r\n */\r\nexport class PDFSetup {\r\n    /**\r\n     * Register the PDFoundry APi on the UI\r\n     */\r\n    public static registerAPI() {\r\n        ui['PDFoundry'] = PDFoundryAPI;\r\n    }\r\n\r\n    /**\r\n     * Inject the CSS file into the header, so it doesn't have to be referenced in the system.json\r\n     */\r\n    public static registerCSS() {\r\n        $('head').append(\r\n            $(`<link href=\"systems/${PDFSettings.EXTERNAL_SYSTEM_NAME}/${PDFSettings.DIST_FOLDER}/bundle.css\" rel=\"stylesheet\" type=\"text/css\" media=\"all\">`),\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Pulls the system name from the script tags.\r\n     */\r\n    public static registerSystem() {\r\n        const scripts = $('script');\r\n        for (let i = 0; i < scripts.length; i++) {\r\n            const script = scripts.get(i) as HTMLScriptElement;\r\n            const folders = script.src.split('/');\r\n            const distIdx = folders.indexOf(PDFSettings.DIST_FOLDER);\r\n            if (distIdx === -1) continue;\r\n\r\n            if (folders[distIdx - 1] === 'pdfoundry') break;\r\n\r\n            PDFSettings.EXTERNAL_SYSTEM_NAME = folders[distIdx - 1];\r\n            break;\r\n        }\r\n        PDFLog.info(`Using ${PDFSettings.EXTERNAL_SYSTEM_NAME} as 'EXTERNAL_SYSTEM_NAME'`);\r\n    }\r\n\r\n    /**\r\n     * Register the PDF sheet and unregister invalid sheet types from it.\r\n     */\r\n    public static registerPDFSheet() {\r\n        Items.registerSheet(PDFSettings.INTERNAL_MODULE_NAME, PDFItemSheet, {\r\n            types: [PDFSettings.PDF_ENTITY_TYPE],\r\n            makeDefault: true,\r\n        });\r\n\r\n        // Unregister all other item sheets for the PDF entity\r\n        const pdfoundryKey = `${PDFSettings.INTERNAL_MODULE_NAME}.${PDFItemSheet.name}`;\r\n        const sheets = CONFIG.Item.sheetClasses[PDFSettings.PDF_ENTITY_TYPE];\r\n        for (const key of Object.keys(sheets)) {\r\n            const sheet = sheets[key];\r\n            // keep the PDFoundry sheet\r\n            if (sheet.id === pdfoundryKey) {\r\n                continue;\r\n            }\r\n\r\n            // id is MODULE.CLASS_NAME\r\n            const [module] = sheet.id.split('.');\r\n            Items.unregisterSheet(module, sheet.cls, {\r\n                types: [PDFSettings.PDF_ENTITY_TYPE],\r\n            });\r\n        }\r\n    }\r\n\r\n    public static userLogin() {\r\n        let viewed;\r\n        try {\r\n            viewed = game.user.getFlag(PDFSettings.INTERNAL_MODULE_NAME, PDFSettings.HELP_SEEN_KEY);\r\n        } catch (error) {\r\n            viewed = false;\r\n        }\r\n\r\n        if (viewed) {\r\n            return;\r\n        }\r\n\r\n        PDFSettings.showHelp();\r\n    }\r\n}\r\n","import { PDFLog } from '../log/PDFLog';\r\nimport { PDFSocketEvent } from './events/PDFSocketEvent';\r\nimport { PDFSettings } from '../settings/PDFSettings';\r\nimport { PDFSetViewEvent } from './events/PDFSetViewEvent';\r\nimport { PDFoundryAPI } from '../api/PDFoundryAPI';\r\n\r\nexport class PDFSocketHandler {\r\n    public static get SOCKET_NAME() {\r\n        return `system.${PDFSettings.EXTERNAL_SYSTEM_NAME}`;\r\n    }\r\n\r\n    public static registerHandlers() {\r\n        // @ts-ignore\r\n        game.socket.on(PDFSocketHandler.SOCKET_NAME, (event) => {\r\n            PDFLog.warn(`Incoming Event: ${event.type}`);\r\n            PDFLog.warn(event);\r\n\r\n            const { userIds, type, payload } = event;\r\n            // null = all users, otherwise check if this event effects us\r\n            if (userIds !== null && !userIds.includes(game.userId)) {\r\n                return;\r\n            }\r\n\r\n            if (type === PDFSetViewEvent.EVENT_TYPE) {\r\n                PDFSocketHandler.handleSetView(payload);\r\n            }\r\n        });\r\n    }\r\n\r\n    public static handleSetView(data: any) {\r\n        PDFoundryAPI.openPDF(data.pdfData, data.page);\r\n    }\r\n}\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFSocketEvent } from './PDFSocketEvent';\r\nimport { PDFData } from '../../types/PDFData';\r\n\r\nexport class PDFSetViewEvent extends PDFSocketEvent {\r\n    public static get EVENT_TYPE() {\r\n        return `${super.EVENT_TYPE}/SET_VIEW`;\r\n    }\r\n\r\n    public page: number;\r\n    public pdfData: PDFData;\r\n\r\n    constructor(userIds: string[]|null, pdfData: PDFData, page: number) {\r\n        super(userIds);\r\n\r\n        this.pdfData = pdfData;\r\n        this.page = page;\r\n    }\r\n\r\n    get type() {\r\n        return PDFSetViewEvent.EVENT_TYPE;\r\n    }\r\n\r\n    protected getPayload() {\r\n        const payload = super.getPayload();\r\n        payload.pdfData = this.pdfData;\r\n        payload.page = this.page;\r\n        return payload;\r\n    }\r\n}\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFSettings } from '../../settings/PDFSettings';\r\nimport { PDFSocketHandler } from '../PDFSocketHandler';\r\nimport { PDFLog } from '../../log/PDFLog';\r\n\r\nexport abstract class PDFSocketEvent {\r\n    public static get EVENT_TYPE() {\r\n        return 'PDFOUNDRY';\r\n    }\r\n\r\n    /**\r\n     * The user ids that should handle this event.\r\n     */\r\n    protected userIds: string[]|null;\r\n\r\n    protected constructor(userIds: string[]|null) {\r\n        this.userIds = userIds;\r\n    }\r\n\r\n    /**\r\n     * The type of this event.\r\n     */\r\n    public abstract get type();\r\n\r\n    /**\r\n     * Get any data that will be sent with the event.\r\n     */\r\n    protected getPayload(): any {\r\n        return {};\r\n    }\r\n\r\n    public emit() {\r\n        // @ts-ignore\r\n        game.socket.emit(PDFSocketHandler.SOCKET_NAME, {\r\n            type: this.type,\r\n            userIds: this.userIds,\r\n            payload: this.getPayload(),\r\n        });\r\n    }\r\n}\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFSettings } from '../settings/PDFSettings';\r\nimport { PDFEvents } from '../events/PDFEvents';\r\nimport { PDFData } from '../types/PDFData';\r\nimport { PDFjsViewer } from '../types/PDFjsViewer';\r\nimport { PDFLog } from '../log/PDFLog';\r\nimport { PDFSetViewEvent } from '../socket/events/PDFSetViewEvent';\r\nimport { PDFUtil } from '../api/PDFUtil';\r\nimport { PDFjsEventBus } from '../types/PDFjsEventBus';\r\n\r\nexport class PDFViewer extends Application {\r\n    static get defaultOptions() {\r\n        const options = super.defaultOptions;\r\n        options.classes = ['app', 'window-app', 'pdfoundry-viewer'];\r\n        options.template = `systems/${PDFSettings.EXTERNAL_SYSTEM_NAME}/pdfoundry-dist/templates/app/pdf-viewer.html`;\r\n        options.title = game.i18n.localize('PDFOUNDRY.VIEWER.ViewPDF');\r\n        options.width = 8.5 * 100 + 64;\r\n        options.height = 11 * 100 + 64;\r\n        options.resizable = true;\r\n        return options;\r\n    }\r\n\r\n    protected _frame: HTMLIFrameElement;\r\n    protected _viewer: PDFjsViewer;\r\n    protected _eventBus: PDFjsEventBus;\r\n    protected _pdfData: PDFData;\r\n\r\n    constructor(pdfData?: PDFData, options?: ApplicationOptions) {\r\n        super(options);\r\n\r\n        if (pdfData === undefined) {\r\n            pdfData = {\r\n                name: game.i18n.localize('PDFOUNDRY.VIEWER.ViewPDF'),\r\n                code: '',\r\n                offset: 0,\r\n                url: '',\r\n                cache: false,\r\n            };\r\n        }\r\n\r\n        this._pdfData = pdfData;\r\n    }\r\n\r\n    // <editor-fold desc=\"Getters & Setters\">\r\n\r\n    /**\r\n     * Returns a copy of the PDFData this viewer is using.\r\n     * Changes to this data will not reflect in the viewer.\r\n     */\r\n    public get pdfData() {\r\n        return duplicate(this._pdfData);\r\n    }\r\n\r\n    public get page() {\r\n        return this._viewer.page;\r\n    }\r\n\r\n    public set page(value: number) {\r\n        this._viewer.page = value;\r\n    }\r\n\r\n    // </editor-fold>\r\n\r\n    // <editor-fold desc=\"Foundry Overrides\">\r\n\r\n    get title(): string {\r\n        let title = this._pdfData.name;\r\n        if (this._pdfData.code !== '') {\r\n            title = `${title} (${this._pdfData.code})`;\r\n        }\r\n        return title;\r\n    }\r\n\r\n    protected _getHeaderButtons(): any[] {\r\n        const buttons = super._getHeaderButtons();\r\n        //TODO: Standardize this to function w/ the Item sheet one\r\n        buttons.unshift({\r\n            class: 'pdf-sheet-github',\r\n            icon: 'fas fa-external-link-alt',\r\n            label: 'PDFoundry',\r\n            onclick: () => window.open('https://github.com/Djphoenix719/PDFoundry', '_blank'),\r\n        });\r\n\r\n        if (game.user.isGM) {\r\n            //TODO: Show to individual players.\r\n            buttons.unshift({\r\n                class: 'pdf-sheet-show-players',\r\n                icon: 'fas fa-eye',\r\n                label: 'Show to Players',\r\n                onclick: () => this.showToPlayers(),\r\n            });\r\n        } else {\r\n            buttons.unshift({\r\n                class: 'pdf-sheet-show-gm',\r\n                icon: 'fas fa-eye',\r\n                label: 'Show to GM',\r\n                onclick: () => this.showToGM(),\r\n            });\r\n        }\r\n\r\n        return buttons;\r\n    }\r\n\r\n    getData(options?: any): any | Promise<any> {\r\n        const data = super.getData(options);\r\n        data.systemName = PDFSettings.EXTERNAL_SYSTEM_NAME;\r\n        return data;\r\n    }\r\n\r\n    protected async activateListeners(html: JQuery<HTMLElement>): Promise<void> {\r\n        super.activateListeners(html);\r\n\r\n        this._frame = html.parent().find('iframe.pdfViewer').get(0) as HTMLIFrameElement;\r\n        this.getViewer().then(async (viewer) => {\r\n            this._viewer = viewer;\r\n\r\n            this.getEventBus().then((eventBus) => {\r\n                this._eventBus = eventBus;\r\n\r\n                const listeners = eventBus._listeners;\r\n                for (const eventName of Object.keys(listeners)) {\r\n                    eventBus.on(eventName, (...args) => {\r\n                        this.logEvent(eventName, args);\r\n                    });\r\n                }\r\n\r\n                // Fire the viewerReady event so the viewer may be used externally\r\n                PDFEvents.fire('viewerReady', this);\r\n            });\r\n        });\r\n    }\r\n\r\n    private logEvent(key: string, ...args) {\r\n        console.debug(key);\r\n        console.debug(args);\r\n    }\r\n\r\n    async close(): Promise<any> {\r\n        PDFEvents.fire('viewerClose', this);\r\n        return super.close();\r\n    }\r\n\r\n    // </editor-fold>\r\n\r\n    /**\r\n     * Show the current page to GMs.\r\n     */\r\n    private showToGM() {\r\n        const pdfData = this.pdfData;\r\n        pdfData.offset = 0;\r\n\r\n        // @ts-ignore\r\n        const ids = PDFUtil.getUserIdsOfRole(USER_ROLES.GAMEMASTER);\r\n        const page = this.page;\r\n\r\n        const event = new PDFSetViewEvent(ids, pdfData, page);\r\n        event.emit();\r\n    }\r\n\r\n    /**\r\n     * Show the current page to players.\r\n     */\r\n    private showToPlayers() {\r\n        const pdfData = this.pdfData;\r\n        pdfData.offset = 0;\r\n\r\n        // @ts-ignore\r\n        const ids = PDFUtil.getUserIdsAtMostRole(USER_ROLES.ASSISTANT);\r\n        const page = this.page;\r\n\r\n        const event = new PDFSetViewEvent(ids, pdfData, page);\r\n        event.emit();\r\n    }\r\n\r\n    /**\r\n     * Wait for the internal PDFjs viewer to be ready and usable.\r\n     */\r\n    private getViewer(): Promise<PDFjsViewer> {\r\n        if (this._viewer) {\r\n            return Promise.resolve(this._viewer);\r\n        }\r\n\r\n        return new Promise<any>((resolve, reject) => {\r\n            let timeout;\r\n            const returnOrWait = () => {\r\n                // If our window has finished initializing...\r\n                if (this._frame) {\r\n                    // If PDFjs has finished initializing...\r\n                    if (this._frame.contentWindow && this._frame.contentWindow['PDFViewerApplication']) {\r\n                        const viewer = this._frame.contentWindow['PDFViewerApplication'];\r\n                        resolve(viewer);\r\n                        return;\r\n                    }\r\n                }\r\n\r\n                // If any ifs fall through, try again in a few ms\r\n                timeout = setTimeout(returnOrWait, 5);\r\n            };\r\n            returnOrWait();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Wait for the internal PDFjs eventBus to be ready and usable.\r\n     */\r\n    private getEventBus(): Promise<PDFjsEventBus> {\r\n        if (this._eventBus) {\r\n            return Promise.resolve(this._eventBus);\r\n        }\r\n\r\n        return new Promise<any>((resolve, reject) => {\r\n            this.getViewer().then((viewer) => {\r\n                let timeout;\r\n                const returnOrWait = () => {\r\n                    if (viewer.eventBus) {\r\n                        resolve(viewer.eventBus);\r\n                        return;\r\n                    }\r\n                    timeout = setTimeout(returnOrWait, 5);\r\n                };\r\n                returnOrWait();\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Finish the download and return the byte array for the file.\r\n     */\r\n    public download(): Promise<Uint8Array> {\r\n        return new Promise<Uint8Array>(async (resolve, reject) => {\r\n            const viewer = await this.getViewer();\r\n            let timeout;\r\n            const returnOrWait = () => {\r\n                if (viewer.downloadComplete) {\r\n                    resolve(viewer.pdfDocument.getData());\r\n                    return;\r\n                }\r\n\r\n                timeout = setTimeout(returnOrWait, 50);\r\n            };\r\n            returnOrWait();\r\n        });\r\n    }\r\n\r\n    public async open(pdfSource: string | Uint8Array, page?: number) {\r\n        const pdfjsViewer = await this.getViewer();\r\n\r\n        if (page) {\r\n            pdfjsViewer.initialBookmark = `page=${page}`;\r\n        }\r\n\r\n        await pdfjsViewer.open(pdfSource);\r\n    }\r\n}\r\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvbW9kdWxlL2FwaS9QREZVdGlsLnRzIiwic3JjL21vZHVsZS9hcGkvUERGb3VuZHJ5QVBJLnRzIiwic3JjL21vZHVsZS9hcHAvUERGSXRlbVNoZWV0LnRzIiwic3JjL21vZHVsZS9jYWNoZS9QREZDYWNoZS50cyIsInNyYy9tb2R1bGUvZXZlbnRzL1BERkV2ZW50cy50cyIsInNyYy9tb2R1bGUvbG9nL1BERkxvZy50cyIsInNyYy9tb2R1bGUvbWFpbi50cyIsInNyYy9tb2R1bGUvc2V0dGluZ3MvUERGSTE4bi50cyIsInNyYy9tb2R1bGUvc2V0dGluZ3MvUERGU2V0dGluZ3MudHMiLCJzcmMvbW9kdWxlL3NldHVwL1BERlNldHVwLnRzIiwic3JjL21vZHVsZS9zb2NrZXQvUERGU29ja2V0SGFuZGxlci50cyIsInNyYy9tb2R1bGUvc29ja2V0L2V2ZW50cy9QREZTZXRWaWV3RXZlbnQudHMiLCJzcmMvbW9kdWxlL3NvY2tldC9ldmVudHMvUERGU29ja2V0RXZlbnQudHMiLCJzcmMvbW9kdWxlL3ZpZXdlci9QREZWaWV3ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0FDQUE7Ozs7Ozs7Ozs7Ozs7R0FhRzs7O0FBS0g7O0dBRUc7QUFDSCxNQUFhLE9BQU87SUFDaEI7Ozs7T0FJRztJQUNJLE1BQU0sQ0FBQyxjQUFjLENBQUMsT0FBZTtRQUN4QyxPQUFPLEdBQUcsTUFBTSxDQUFDLE1BQU0sSUFBSSxPQUFPLEVBQUUsQ0FBQztJQUN6QyxDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksTUFBTSxDQUFDLGtCQUFrQixDQUFDLElBQVU7UUFDdkMsSUFBSSxJQUFJLEtBQUssU0FBUyxJQUFJLElBQUksS0FBSyxJQUFJLEVBQUU7WUFDckMsT0FBTyxJQUFJLENBQUM7U0FDZjtRQUVELE1BQU0sRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsR0FB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Q0FBQztJQUVZLElBQUksQ0FBQyxTQUE4QixFQUFFLElBQWE7O1lBQzNELE1BQU0sV0FBVyxHQUFHLE1BQU0sSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDO1lBRTNDLElBQUksSUFBSSxFQUFFO2dCQUNOLFdBQVcsQ0FBQyxlQUFlLEdBQUcsUUFBUSxJQUFJLEVBQUUsQ0FBQzthQUNoRDtZQUVELE1BQU0sV0FBVyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUN0QyxDQUFDO0tBQUE7Q0FDSjtBQW5QRCw4QkFtUEMiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCIvKiBDb3B5cmlnaHQgMjAyMCBBbmRyZXcgQ3VjY2luZWxsb1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcblxyXG5pbXBvcnQgeyBQREZEYXRhIH0gZnJvbSAnLi4vdHlwZXMvUERGRGF0YSc7XHJcbmltcG9ydCB7IFBERkxvZyB9IGZyb20gJy4uL2xvZy9QREZMb2cnO1xyXG5cclxuLyoqXHJcbiAqIENvbnRhaW5zIHZhcmlvdXMgdXRpbGl0eSBmdW5jdGlvbnMgZm9yIGNvbW1vbiBvcGVyYXRpb25zLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFBERlV0aWwge1xyXG4gICAgLyoqXHJcbiAgICAgKiBIZWxwZXIgbWV0aG9kLiBDb252ZXJ0IGEgcmVsYXRpdmUgVVJMIHRvIGEgYWJzb2x1dGUgVVJMXHJcbiAgICAgKiAgYnkgcHJlcGVuZGluZyB0aGUgd2luZG93IG9yaWdpbiB0byB0aGUgcmVsYXRpdmUgVVJMLlxyXG4gICAgICogQHBhcmFtIGRhdGFVcmxcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXRBYnNvbHV0ZVVSTChkYXRhVXJsOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiBgJHt3aW5kb3cub3JpZ2lufS8ke2RhdGFVcmx9YDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFB1bGwgcmVsZXZhbnQgZGF0YSBmcm9tIGFuIGl0ZW0sIGNyZWF0aW5nIGEge0BsaW5rIFBERkRhdGF9LlxyXG4gICAgICogQHBhcmFtIGl0ZW0gVGhlIGl0ZW0gdG8gcHVsbCBkYXRhIGZyb20uXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0UERGRGF0YUZyb21JdGVtKGl0ZW06IEl0ZW0pOiBQREZEYXRhIHwgbnVsbCB7XHJcbiAgICAgICAgaWYgKGl0ZW0gPT09IHVuZGVmaW5lZCB8fCBpdGVtID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgeyBjb2RlLCB1cmwsIG9mZnNldCwgY2FjaGUgfSA9IGl0ZW0uZGF0YS5kYXRhO1xyXG4gICAgICAgIGNvbnN0IG5hbWUgPSBpdGVtLm5hbWU7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG5hbWUsXHJcbiAgICAgICAgICAgIGNvZGUsXHJcbiAgICAgICAgICAgIHVybCxcclxuICAgICAgICAgICAgb2Zmc2V0LFxyXG4gICAgICAgICAgICBjYWNoZSxcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBVUkwgc3RhcnRzIHdpdGggdGhlIG9yaWdpbi5cclxuICAgICAqIEBwYXJhbSBkYXRhVXJsIEEgdXJsLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIHZhbGlkYXRlQWJzb2x1dGVVUkwoZGF0YVVybDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIGRhdGFVcmwuc3RhcnRzV2l0aCh3aW5kb3cub3JpZ2luKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIGdldFVzZXJJZHNPZlJvbGUocm9sZTogbnVtYmVyKSB7XHJcbiAgICAgICAgcmV0dXJuIGdhbWUudXNlcnNcclxuICAgICAgICAgICAgLmZpbHRlcigodXNlcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVzZXIucm9sZSA9PT0gcm9sZTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLm1hcCgodXNlcikgPT4gdXNlci5pZCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBnZXRVc2VySWRzQXRMZWFzdFJvbGUocm9sZTogbnVtYmVyKSB7XHJcbiAgICAgICAgcmV0dXJuIGdhbWUudXNlcnNcclxuICAgICAgICAgICAgLmZpbHRlcigodXNlcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVzZXIucm9sZSA+PSByb2xlO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAubWFwKCh1c2VyKSA9PiB1c2VyLmlkKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIGdldFVzZXJJZHNBdE1vc3RSb2xlKHJvbGU6IG51bWJlcikge1xyXG4gICAgICAgIHJldHVybiBnYW1lLnVzZXJzXHJcbiAgICAgICAgICAgIC5maWx0ZXIoKHVzZXIpID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB1c2VyLnJvbGUgPD0gcm9sZTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLm1hcCgodXNlcikgPT4gdXNlci5pZCk7XHJcbiAgICB9XHJcbn1cclxuIiwiLyogQ29weXJpZ2h0IDIwMjAgQW5kcmV3IEN1Y2NpbmVsbG9cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgUERGU2V0dGluZ3MgfSBmcm9tICcuLi9zZXR0aW5ncy9QREZTZXR0aW5ncyc7XHJcbmltcG9ydCB7IFBERlZpZXdlciB9IGZyb20gJy4uL3ZpZXdlci9QREZWaWV3ZXInO1xyXG5pbXBvcnQgeyBQREZDYWNoZSB9IGZyb20gJy4uL2NhY2hlL1BERkNhY2hlJztcclxuaW1wb3J0IHsgUERGRXZlbnRzIH0gZnJvbSAnLi4vZXZlbnRzL1BERkV2ZW50cyc7XHJcbmltcG9ydCB7IFBERlV0aWwgfSBmcm9tICcuL1BERlV0aWwnO1xyXG5pbXBvcnQgeyBQREZEYXRhIH0gZnJvbSAnLi4vdHlwZXMvUERGRGF0YSc7XHJcblxyXG50eXBlIEl0ZW1Db21wYXJlciA9IChpdGVtOiBJdGVtKSA9PiBib29sZWFuO1xyXG5cclxuLyoqXHJcbiAqIFRoZSBQREZvdW5kcnkgQVBJIDxicj5cclxuICogWW91IGNhbiBhY2Nlc3MgdGhlIEFQSSB3aXRoIGB1aS5QREZvdW5kcnlgXHJcbiAqIEBtb2R1bGUgQVBJXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUERGb3VuZHJ5QVBJIHtcclxuICAgIC8qKlxyXG4gICAgICogQSByZWZlcmVuY2UgdG8gdGhlIHN0YXRpYyB7QGxpbmsgUERGRXZlbnRzfSBjbGFzcy5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXQgZXZlbnRzKCkge1xyXG4gICAgICAgIHJldHVybiBQREZFdmVudHM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBIHJlZmVyZW5jZSB0byB0aGUgc3RhdGljIHtAbGluayBQREZVdGlsfSBjbGFzcy5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXQgdXRpbCgpIHtcclxuICAgICAgICByZXR1cm4gUERGVXRpbDtcclxuICAgIH1cclxuXHJcbiAgICAvLyA8ZWRpdG9yLWZvbGQgZGVzYz1cIkdldFBERkRhdGEgTWV0aG9kc1wiPlxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSGVscGVyIG1ldGhvZC4gQWxpYXMgZm9yIHtAbGluayBQREZvdW5kcnlBUEkuZ2V0UERGRGF0YX0gd2l0aCBhXHJcbiAgICAgKiAgY29tcGFyZXIgdGhhdCBzZWFyY2hlcyBieSBQREYgQ29kZS5cclxuICAgICAqIEBwYXJhbSBjb2RlIFdoaWNoIGNvZGUgdG8gc2VhcmNoIGZvciBhIFBERiB3aXRoLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGdldFBERkRhdGFCeUNvZGUoY29kZTogc3RyaW5nKTogUERGRGF0YSB8IG51bGwge1xyXG4gICAgICAgIHJldHVybiBQREZvdW5kcnlBUEkuZ2V0UERGRGF0YSgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gaXRlbS5kYXRhLmRhdGEuY29kZSA9PT0gY29kZTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEhlbHBlciBtZXRob2QuIEFsaWFzIGZvciB7QGxpbmsgUERGb3VuZHJ5QVBJLmdldFBERkRhdGF9IHdpdGggYVxyXG4gICAgICogIGNvbXBhcmVyIHRoYXQgc2VhcmNoZXMgYnkgUERGIE5hbWUuXHJcbiAgICAgKiBAcGFyYW0gbmFtZSBXaGljaCBuYW1lIHRvIHNlYXJjaCBmb3IgYSBQREYgd2l0aC5cclxuICAgICAqIEBwYXJhbSBjYXNlSW5zZW5zaXRpdmUgSWYgYSBjYXNlIGluc2Vuc2l0aXZlIHNlYXJjaCBzaG91bGQgYmUgZG9uZS5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXRQREZEYXRhQnlOYW1lKG5hbWU6IHN0cmluZywgY2FzZUluc2Vuc2l0aXZlOiBib29sZWFuID0gdHJ1ZSk6IFBERkRhdGEgfCBudWxsIHtcclxuICAgICAgICBpZiAoY2FzZUluc2Vuc2l0aXZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQREZvdW5kcnlBUEkuZ2V0UERGRGF0YSgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0ubmFtZS50b0xvd2VyQ2FzZSgpID09PSBuYW1lLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQREZvdW5kcnlBUEkuZ2V0UERGRGF0YSgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0ubmFtZSA9PT0gbmFtZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRmluZHMgYSBQREYgZW50aXR5IGNyZWF0ZWQgYnkgdGhlIHVzZXIgYW5kIGNvbnN0cnVjdHMgYVxyXG4gICAgICogIHtAbGluayBQREZEYXRhfSBvYmplY3Qgb2YgdGhlIHJlc3VsdGluZyBQREYncyBkYXRhLlxyXG4gICAgICogQHBhcmFtIGNvbXBhcmVyIEEgY29tcGFyaXNvbiBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgdXNlZC5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXRQREZEYXRhKGNvbXBhcmVyOiBJdGVtQ29tcGFyZXIpOiBQREZEYXRhIHwgbnVsbCB7XHJcbiAgICAgICAgY29uc3QgcGRmOiBJdGVtID0gZ2FtZS5pdGVtcy5maW5kKChpdGVtOiBJdGVtKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiBpdGVtLnR5cGUgPT09IFBERlNldHRpbmdzLlBERl9FTlRJVFlfVFlQRSAmJiBjb21wYXJlcihpdGVtKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIFBERlV0aWwuZ2V0UERGRGF0YUZyb21JdGVtKHBkZik7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cclxuXHJcbiAgICAvLyA8ZWRpdG9yLWZvbGQgZGVzYz1cIk9wZW5QREYgTWV0aG9kc1wiPlxyXG5cclxuICAgIC8qKlxyXG4gICAgICogT3BlbiB0aGUgUERGIHdpdGggdGhlIHByb3ZpZGVkIGNvZGUgdG8gdGhlIHNwZWNpZmllZCBwYWdlLlxyXG4gICAgICogSGVscGVyIGZvciB7QGxpbmsgZ2V0UERGRGF0YUJ5Q29kZX0gdGhlbiB7QGxpbmsgb3BlblBERn0uXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgYXN5bmMgb3BlblBERkJ5Q29kZShjb2RlOiBzdHJpbmcsIHBhZ2U6IG51bWJlciA9IDEpIHtcclxuICAgICAgICBjb25zdCBwZGYgPSB0aGlzLmdldFBERkRhdGFCeUNvZGUoY29kZSk7XHJcblxyXG4gICAgICAgIGlmIChwZGYgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgY29uc3QgZXJyb3IgPSBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5FUlJPUi5Ob1BERldpdGhDb2RlJyk7XHJcblxyXG4gICAgICAgICAgICBpZiAoUERGU2V0dGluZ3MuTk9USUZJQ0FUSU9OUykge1xyXG4gICAgICAgICAgICAgICAgdWkubm90aWZpY2F0aW9ucy5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5vcGVuUERGKHBkZiwgcGFnZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBPcGVuIHRoZSBQREYgd2l0aCB0aGUgcHJvdmlkZWQgY29kZSB0byB0aGUgc3BlY2lmaWVkIHBhZ2UuXHJcbiAgICAgKiBIZWxwZXIgZm9yIHtAbGluayBnZXRQREZEYXRhQnlDb2RlfSB0aGVuIHtAbGluayBvcGVuUERGfS5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBvcGVuUERGQnlOYW1lKG5hbWU6IHN0cmluZywgcGFnZTogbnVtYmVyID0gMSkge1xyXG4gICAgICAgIGNvbnN0IHBkZiA9IHRoaXMuZ2V0UERGRGF0YUJ5TmFtZShuYW1lKTtcclxuXHJcbiAgICAgICAgaWYgKHBkZiA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlID0gZ2FtZS5pMThuLmxvY2FsaXplKCdQREZPVU5EUlkuRVJST1IuTm9QREZXaXRoTmFtZScpO1xyXG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcihtZXNzYWdlKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChQREZTZXR0aW5ncy5OT1RJRklDQVRJT05TKSB7XHJcbiAgICAgICAgICAgICAgICB1aS5ub3RpZmljYXRpb25zLmVycm9yKGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMub3BlblBERihwZGYsIHBhZ2UpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogT3BlbiB0aGUgcHJvdmlkZWQge0BsaW5rIFBERkRhdGF9IHRvIHRoZSBzcGVjaWZpZWQgcGFnZS5cclxuICAgICAqIEBwYXJhbSBwZGYgVGhlIFBERiB0byBvcGVuLiBTZWUge0BsaW5rIFBERm91bmRyeUFQSS5nZXRQREZEYXRhfS5cclxuICAgICAqIEBwYXJhbSBwYWdlIFRoZSBwYWdlIHRvIG9wZW4gdGhlIFBERiB0by5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBvcGVuUERGKHBkZjogUERGRGF0YSwgcGFnZTogbnVtYmVyID0gMSkge1xyXG4gICAgICAgIGxldCB7IHVybCwgb2Zmc2V0LCBjYWNoZSB9ID0gcGRmO1xyXG5cclxuICAgICAgICBpZiAodHlwZW9mIG9mZnNldCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgb2Zmc2V0ID0gcGFyc2VJbnQob2Zmc2V0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghUERGVXRpbC52YWxpZGF0ZUFic29sdXRlVVJMKHVybCkpIHtcclxuICAgICAgICAgICAgdXJsID0gUERGVXRpbC5nZXRBYnNvbHV0ZVVSTCh1cmwpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3Qgdmlld2VyID0gbmV3IFBERlZpZXdlcihwZGYpO1xyXG4gICAgICAgIHZpZXdlci5yZW5kZXIodHJ1ZSk7XHJcblxyXG4gICAgICAgIGF3YWl0IFBERm91bmRyeUFQSS5faGFuZGxlT3Blbih2aWV3ZXIsIHVybCwgcGFnZSArIG9mZnNldCwgY2FjaGUpO1xyXG5cclxuICAgICAgICByZXR1cm4gdmlld2VyO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogT3BlbiBhIFVSTCBhcyBhIFBERi5cclxuICAgICAqIEBwYXJhbSB1cmwgVGhlIFVSTCB0byBvcGVuIChtdXN0IGJlIGFic29sdXRlKS5cclxuICAgICAqIEBwYXJhbSBwYWdlIFdoaWNoIHBhZ2UgdG8gb3BlbiB0by4gTXVzdCBiZSA+PSAxLlxyXG4gICAgICogQHBhcmFtIGNhY2hlIElmIFVSTCBiYXNlZCBjYWNoaW5nIHNob3VsZCBiZSB1c2VkLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIG9wZW5VUkwodXJsOiBzdHJpbmcsIHBhZ2U6IG51bWJlciA9IDEsIGNhY2hlOiBib29sZWFuID0gdHJ1ZSk6IFByb21pc2U8UERGVmlld2VyPiB7XHJcbiAgICAgICAgaWYgKGlzTmFOKHBhZ2UpIHx8IHBhZ2UgPD0gMCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFBhZ2UgbXVzdCBiZSA+IDAsIGJ1dCAke3BhZ2V9IHdhcyBnaXZlbi5gKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghUERGVXRpbC52YWxpZGF0ZUFic29sdXRlVVJMKHVybCkpIHtcclxuICAgICAgICAgICAgdXJsID0gUERGVXRpbC5nZXRBYnNvbHV0ZVVSTCh1cmwpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3Qgdmlld2VyID0gbmV3IFBERlZpZXdlcigpO1xyXG4gICAgICAgIHZpZXdlci5yZW5kZXIodHJ1ZSk7XHJcblxyXG4gICAgICAgIGF3YWl0IFBERm91bmRyeUFQSS5faGFuZGxlT3Blbih2aWV3ZXIsIHVybCwgcGFnZSwgY2FjaGUpO1xyXG5cclxuICAgICAgICByZXR1cm4gdmlld2VyO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc3RhdGljIGFzeW5jIF9oYW5kbGVPcGVuKHZpZXdlcjogUERGVmlld2VyLCB1cmw6IHN0cmluZywgcGFnZTogbnVtYmVyLCBjYWNoZTogYm9vbGVhbikge1xyXG4gICAgICAgIGlmIChjYWNoZSkge1xyXG4gICAgICAgICAgICBjb25zdCBjYWNoZWRCeXRlcyA9IGF3YWl0IFBERkNhY2hlLmdldENhY2hlKHVybCk7XHJcbiAgICAgICAgICAgIC8vIElmIHdlIGhhdmUgYSBjYWNoZSBoaXQgb3BlbiB0aGUgY2FjaGVkIGRhdGFcclxuICAgICAgICAgICAgaWYgKGNhY2hlZEJ5dGVzKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB2aWV3ZXIub3BlbihjYWNoZWRCeXRlcywgcGFnZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBPdGhlcndpc2Ugd2Ugc2hvdWxkIG9wZW4gaXQgYnkgdXJsXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB2aWV3ZXIub3Blbih1cmwsIHBhZ2UpO1xyXG4gICAgICAgICAgICAgICAgLy8gQW5kIHdoZW4gdGhlIGRvd25sb2FkIGlzIGNvbXBsZXRlIHNldCB0aGUgY2FjaGVcclxuICAgICAgICAgICAgICAgIHZpZXdlci5kb3dubG9hZCgpLnRoZW4oKGJ5dGVzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgUERGQ2FjaGUuc2V0Q2FjaGUodXJsLCBieXRlcyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGF3YWl0IHZpZXdlci5vcGVuKHVybCwgcGFnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIDwvZWRpdG9yLWZvbGQ+XHJcbn1cclxuIiwiLyogQ29weXJpZ2h0IDIwMjAgQW5kcmV3IEN1Y2NpbmVsbG9cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgUERGU2V0dGluZ3MgfSBmcm9tICcuLi9zZXR0aW5ncy9QREZTZXR0aW5ncyc7XHJcbmltcG9ydCB7IFBERm91bmRyeUFQSSB9IGZyb20gJy4uL2FwaS9QREZvdW5kcnlBUEknO1xyXG5pbXBvcnQgeyBQREZMb2cgfSBmcm9tICcuLi9sb2cvUERGTG9nJztcclxuXHJcbi8qKlxyXG4gKiBFeHRlbmRzIHRoZSBiYXNlIEl0ZW1TaGVldCBmb3IgbGlua2VkIFBERiB2aWV3aW5nLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFBERkl0ZW1TaGVldCBleHRlbmRzIEl0ZW1TaGVldCB7XHJcbiAgICBzdGF0aWMgZ2V0IGRlZmF1bHRPcHRpb25zKCkge1xyXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSBzdXBlci5kZWZhdWx0T3B0aW9ucztcclxuICAgICAgICBvcHRpb25zLmNsYXNzZXMgPSBbJ3NoZWV0JywgJ2l0ZW0nXTtcclxuICAgICAgICBvcHRpb25zLndpZHRoID0gNjUwO1xyXG4gICAgICAgIG9wdGlvbnMuaGVpZ2h0ID0gJ2F1dG8nO1xyXG4gICAgICAgIHJldHVybiBvcHRpb25zO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCB0ZW1wbGF0ZSgpIHtcclxuICAgICAgICByZXR1cm4gYHN5c3RlbXMvJHtQREZTZXR0aW5ncy5FWFRFUk5BTF9TWVNURU1fTkFNRX0vJHtQREZTZXR0aW5ncy5ESVNUX0ZPTERFUn0vdGVtcGxhdGVzL3NoZWV0L3BkZi1zaGVldC5odG1sYDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEhlbHBlciBtZXRob2QgdG8gZ2V0IGEgaWQgaW4gdGhlIGh0bWwgZm9ybVxyXG4gICAgICogaHRtbCBpZHMgYXJlIHByZXBlbmRlZCB3aXRoIHRoZSBpZCBvZiB0aGUgaXRlbSB0byBwcmVzZXJ2ZSB1bmlxdWVuZXNzXHJcbiAgICAgKiAgd2hpY2ggaXMgbWFuZGF0b3J5IHRvIGFsbG93IG11bHRpcGxlIGZvcm1zIHRvIGJlIG9wZW5cclxuICAgICAqIEBwYXJhbSBodG1sXHJcbiAgICAgKiBAcGFyYW0gaWRcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBfZ2V0QnlJRChodG1sOiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCBpZDogc3RyaW5nKTogSlF1ZXJ5PEhUTUxFbGVtZW50PiB7XHJcbiAgICAgICAgcmV0dXJuIGh0bWwucGFyZW50KCkucGFyZW50KCkuZmluZChgIyR7dGhpcy5pdGVtLl9pZH0tJHtpZH1gKTtcclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgX2dldEhlYWRlckJ1dHRvbnMoKTogYW55W10ge1xyXG4gICAgICAgIGNvbnN0IGJ1dHRvbnMgPSBzdXBlci5fZ2V0SGVhZGVyQnV0dG9ucygpO1xyXG4gICAgICAgIGJ1dHRvbnMudW5zaGlmdCh7XHJcbiAgICAgICAgICAgIGNsYXNzOiAncGRmLXNoZWV0LW1hbnVhbCcsXHJcbiAgICAgICAgICAgIGljb246ICdmYXMgZmEtcXVlc3Rpb24tY2lyY2xlJyxcclxuICAgICAgICAgICAgbGFiZWw6ICdIZWxwJyxcclxuICAgICAgICAgICAgb25jbGljazogKCkgPT4gUERGU2V0dGluZ3Muc2hvd0hlbHAoKSxcclxuICAgICAgICB9KTtcclxuICAgICAgICAvL1RPRE86IFN0YW5kYXJkaXplIHRoaXMgdG8gZnVuY3Rpb24gdy8gdGhlIFZpZXdlciBvbmVcclxuICAgICAgICBidXR0b25zLnVuc2hpZnQoe1xyXG4gICAgICAgICAgICBjbGFzczogJ3BkZi1zaGVldC1naXRodWInLFxyXG4gICAgICAgICAgICBpY29uOiAnZmFzIGZhLWV4dGVybmFsLWxpbmstYWx0JyxcclxuICAgICAgICAgICAgbGFiZWw6ICdQREZvdW5kcnknLFxyXG4gICAgICAgICAgICBvbmNsaWNrOiAoKSA9PiB3aW5kb3cub3BlbignaHR0cHM6Ly9naXRodWIuY29tL0RqcGhvZW5peDcxOS9QREZvdW5kcnknLCAnX2JsYW5rJyksXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGJ1dHRvbnM7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIGFjdGl2YXRlTGlzdGVuZXJzKGh0bWw6IEpRdWVyeTxIVE1MRWxlbWVudD4pOiB2b2lkIHtcclxuICAgICAgICBzdXBlci5hY3RpdmF0ZUxpc3RlbmVycyhodG1sKTtcclxuXHJcbiAgICAgICAgY29uc3QgdXJsSW5wdXQgPSB0aGlzLl9nZXRCeUlEKGh0bWwsICdkYXRhXFxcXC51cmwnKTtcclxuICAgICAgICBjb25zdCBvZmZzZXRJbnB1dCA9IHRoaXMuX2dldEJ5SUQoaHRtbCwgJ2RhdGFcXFxcLm9mZnNldCcpO1xyXG5cclxuICAgICAgICAvLyBCbG9jayBlbnRlciBmcm9tIGRpc3BsYXlpbmcgdGhlIFBERlxyXG4gICAgICAgIGh0bWwuZmluZCgnaW5wdXQnKS5vbigna2V5cHJlc3MnLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VudGVyJykge1xyXG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBUZXN0IGJ1dHRvblxyXG4gICAgICAgIHRoaXMuX2dldEJ5SUQoaHRtbCwgJ3BkZi10ZXN0Jykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgICAgICBsZXQgdXJsVmFsdWUgPSB1cmxJbnB1dC52YWwoKTtcclxuICAgICAgICAgICAgbGV0IG9mZnNldFZhbHVlID0gb2Zmc2V0SW5wdXQudmFsKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAodXJsVmFsdWUgPT09IG51bGwgfHwgdXJsVmFsdWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuO1xyXG4gICAgICAgICAgICBpZiAob2Zmc2V0VmFsdWUgPT09IG51bGwgfHwgb2Zmc2V0VmFsdWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgdXJsVmFsdWUgPSBgJHt3aW5kb3cubG9jYXRpb24ub3JpZ2lufS8ke3VybFZhbHVlfWA7XHJcblxyXG4gICAgICAgICAgICBpZiAob2Zmc2V0VmFsdWUudG9TdHJpbmcoKS50cmltKCkgPT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICBvZmZzZXRWYWx1ZSA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb2Zmc2V0VmFsdWUgPSBwYXJzZUludChvZmZzZXRWYWx1ZSBhcyBzdHJpbmcpO1xyXG5cclxuICAgICAgICAgICAgUERGb3VuZHJ5QVBJLm9wZW5VUkwodXJsVmFsdWUsIDUgKyBvZmZzZXRWYWx1ZSwgZmFsc2UpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBCcm93c2UgYnV0dG9uXHJcbiAgICAgICAgdGhpcy5fZ2V0QnlJRChodG1sLCAncGRmLWJyb3dzZScpLm9uKCdjbGljaycsIGFzeW5jIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZnAgPSBuZXcgRmlsZVBpY2tlcih7fSk7XHJcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgVE9ETzogZm91bmRyeS1wYy10eXBlc1xyXG4gICAgICAgICAgICBmcC5leHRlbnNpb25zID0gWycucGRmJ107XHJcbiAgICAgICAgICAgIGZwLmZpZWxkID0gdXJsSW5wdXRbMF07XHJcblxyXG4gICAgICAgICAgICBsZXQgdXJsVmFsdWUgPSB1cmxJbnB1dC52YWwoKTtcclxuICAgICAgICAgICAgaWYgKHVybFZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IGZwLmJyb3dzZSh1cmxWYWx1ZS50b1N0cmluZygpLnRyaW0oKSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZwLnJlbmRlcih0cnVlKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG4iLCIvKiBDb3B5cmlnaHQgMjAyMCBBbmRyZXcgQ3VjY2luZWxsb1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmltcG9ydCB7IFBERlZpZXdlciB9IGZyb20gJy4uL3ZpZXdlci9QREZWaWV3ZXInO1xyXG5pbXBvcnQgeyBQREZTZXR0aW5ncyB9IGZyb20gJy4uL3NldHRpbmdzL1BERlNldHRpbmdzJztcclxuaW1wb3J0IHsgUERGTG9nIH0gZnJvbSAnLi4vbG9nL1BERkxvZyc7XHJcblxyXG4vKipcclxuICogRXJyb3IgdGhhdCBvY2N1cnMgZHVyaW5nIElEQiBvcGVyYXRpb25zXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgSURCSGVscGVyRXJyb3IgZXh0ZW5kcyBFcnJvciB7XHJcbiAgICBjb25zdHJ1Y3RvcihpbmRleDogc3RyaW5nLCBzdG9yZTogc3RyaW5nLCBtZXNzYWdlPzogc3RyaW5nKSB7XHJcbiAgICAgICAgc3VwZXIoYEVycm9yIGluICR7aW5kZXh9PiR7c3RvcmV9OiAke21lc3NhZ2V9YCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDbGFzcyB0aGF0IGRlYWxzIHdpdGggZ2V0dGluZy9zZXR0aW5nIGZyb20gYW4gaW5kZXhlZCBkYlxyXG4gKiBNb3N0bHkgZXhpc3RzIHRvIHNlcGFyYXRlIGxvZ2ljIGZvciB0aGUgUERGQ2FjaGUgZnJvbSBsb2dpY1xyXG4gKiAgZGVhbGluZyB3aXRoIHRoZSBkYXRhYmFzZVxyXG4gKi9cclxuY2xhc3MgSURCSGVscGVyIHtcclxuICAgIHByaXZhdGUgX3ZlcnNpb246IG51bWJlcjtcclxuXHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IF9pbmRleE5hbWU6IHN0cmluZztcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgX3N0b3JlTmFtZXM6IHN0cmluZ1tdO1xyXG5cclxuICAgIHByaXZhdGUgX2RiOiBJREJEYXRhYmFzZTtcclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIGNyZWF0ZUFuZE9wZW4oaW5kZXhOYW1lOiBzdHJpbmcsIHN0b3JlTmFtZXM6IHN0cmluZ1tdLCB2ZXJzaW9uOiBudW1iZXIpIHtcclxuICAgICAgICBjb25zdCBoZWxwZXIgPSBuZXcgSURCSGVscGVyKGluZGV4TmFtZSwgc3RvcmVOYW1lcywgdmVyc2lvbik7XHJcbiAgICAgICAgYXdhaXQgaGVscGVyLm9wZW4oKTtcclxuICAgICAgICByZXR1cm4gaGVscGVyO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXQgcmVhZHkoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2RiICE9PSB1bmRlZmluZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKGluZGV4TmFtZTogc3RyaW5nLCBzdG9yZU5hbWVzOiBzdHJpbmdbXSwgdmVyc2lvbjogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5faW5kZXhOYW1lID0gYCR7aW5kZXhOYW1lfWA7XHJcbiAgICAgICAgdGhpcy5fc3RvcmVOYW1lcyA9IHN0b3JlTmFtZXM7XHJcbiAgICAgICAgdGhpcy5fdmVyc2lvbiA9IHZlcnNpb247XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBuZXdUcmFuc2FjdGlvbihzdG9yZU5hbWU6IHN0cmluZykge1xyXG4gICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gdGhpcy5fZGIudHJhbnNhY3Rpb24oc3RvcmVOYW1lLCAncmVhZHdyaXRlJyk7XHJcbiAgICAgICAgY29uc3Qgc3RvcmUgPSB0cmFuc2FjdGlvbi5vYmplY3RTdG9yZShzdG9yZU5hbWUpO1xyXG4gICAgICAgIHJldHVybiB7IHRyYW5zYWN0aW9uLCBzdG9yZSB9O1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBvcGVuKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICAgIGNvbnN0IHRoYXQgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZTx2b2lkPihmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3QgPSBpbmRleGVkREIub3Blbih0aGF0Ll9pbmRleE5hbWUsIHRoYXQuX3ZlcnNpb24pO1xyXG4gICAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgdGhhdC5fZGIgPSB0aGlzLnJlc3VsdDtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgcmVxdWVzdC5vbnVwZ3JhZGVuZWVkZWQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIHRoYXQuX2RiID0gdGhpcy5yZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoYXQuX3N0b3JlTmFtZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgb2JqZWN0IHN0b3JlIGlmIGl0IGRvZXNuJ3QgZXhpc3RcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5fZGIuY3JlYXRlT2JqZWN0U3RvcmUodGhhdC5fc3RvcmVOYW1lc1tpXSwge30pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE90aGVyd2lzZSBwYXNzXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgICAgICAgICAgIHJlamVjdChldmVudC50YXJnZXQuZXJyb3IpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzZXQoa2V5OiBJREJWYWxpZEtleSwgdmFsdWU6IGFueSwgc3RvcmVOYW1lOiBzdHJpbmcsIGZvcmNlOiBib29sZWFuID0gZmFsc2UpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuX2RiKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSURCSGVscGVyRXJyb3IodGhpcy5faW5kZXhOYW1lLCBzdG9yZU5hbWUsICdEYXRhYmFzZSBpcyBub3QgaW5pdGlhbGl6ZWQuJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0aGF0ID0gdGhpcztcclxuICAgICAgICAgICAgICAgIGxldCB7IHRyYW5zYWN0aW9uLCBzdG9yZSB9ID0gdGhpcy5uZXdUcmFuc2FjdGlvbihzdG9yZU5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIFByb3BhZ2F0ZSBlcnJvcnMgdXB3YXJkcywgb3RoZXJ3aXNlIHRoZXkgZmFpbCBzaWxlbnRseVxyXG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb24ub25lcnJvciA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXZlbnQudGFyZ2V0LmVycm9yKTtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3Qga2V5UmVxdWVzdCA9IHN0b3JlLmdldEtleShrZXkpO1xyXG4gICAgICAgICAgICAgICAga2V5UmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBrZXkgYWxyZWFkeSBleGlzdHMgaW4gdGhlIHN0b3JlXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtleVJlcXVlc3QucmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNob3VsZCB3ZSBmb3JjZSB0aGUgbmV3IHZhbHVlIGJ5IGRlbGV0aW5nIHRoZSBvbGQ/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb3JjZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5kZWwoa2V5LCBzdG9yZU5hbWUpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh7IHRyYW5zYWN0aW9uLCBzdG9yZSB9ID0gdGhhdC5uZXdUcmFuc2FjdGlvbihzdG9yZU5hbWUpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdG9yZS5hZGQodmFsdWUsIGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSURCSGVscGVyRXJyb3IodGhhdC5faW5kZXhOYW1lLCBzdG9yZU5hbWUsIGBLZXkgJHtrZXl9IGFscmVhZHkgZXhpc3RzLmApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmUuYWRkKHZhbHVlLCBrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXQoa2V5OiBJREJWYWxpZEtleSwgc3RvcmVOYW1lOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZTx2b2lkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5fZGIpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBJREJIZWxwZXJFcnJvcih0aGlzLl9pbmRleE5hbWUsIHN0b3JlTmFtZSwgJ0RhdGFiYXNlIGlzIG5vdCBpbml0aWFsaXplZC4nKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGxldCB7IHRyYW5zYWN0aW9uLCBzdG9yZSB9ID0gdGhpcy5uZXdUcmFuc2FjdGlvbihzdG9yZU5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIFByb3BhZ2F0ZSBlcnJvcnMgdXB3YXJkcywgb3RoZXJ3aXNlIHRoZXkgZmFpbCBzaWxlbnRseVxyXG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb24ub25lcnJvciA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXZlbnQudGFyZ2V0LmVycm9yKTtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgZ2V0UmVxdWVzdCA9IHN0b3JlLmdldChrZXkpO1xyXG4gICAgICAgICAgICAgICAgZ2V0UmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRoaXMucmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgZ2V0UmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChldmVudC50YXJnZXQuZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBkZWwoa2V5OiBJREJWYWxpZEtleSwgc3RvcmVOYW1lOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgeyB0cmFuc2FjdGlvbiwgc3RvcmUgfSA9IHRoaXMubmV3VHJhbnNhY3Rpb24oc3RvcmVOYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbi5vbmVycm9yID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChldmVudC50YXJnZXQuZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uLm9uY29tcGxldGUgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIHN0b3JlLmRlbGV0ZShrZXkpO1xyXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBrZXlzKHN0b3JlTmFtZTogc3RyaW5nKTogUHJvbWlzZTxJREJWYWxpZEtleVtdPiB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPElEQlZhbGlkS2V5W10+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHsgdHJhbnNhY3Rpb24sIHN0b3JlIH0gPSB0aGlzLm5ld1RyYW5zYWN0aW9uKHN0b3JlTmFtZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBrZXlzUmVxdWVzdCA9IHN0b3JlLmdldEFsbEtleXMoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBrZXlzUmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShrZXlzUmVxdWVzdC5yZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGtleXNSZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGV2ZW50LnRhcmdldC5lcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2xyKHN0b3JlTmFtZTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHsgc3RvcmUgfSA9IHRoaXMubmV3VHJhbnNhY3Rpb24oc3RvcmVOYW1lKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGtleXMgPSBzdG9yZS5nZXRBbGxLZXlzKCk7XHJcbiAgICAgICAgICAgICAgICBrZXlzLm9uc3VjY2VzcyA9IChyZXN1bHQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9taXNlczogUHJvbWlzZTx2b2lkPltdID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cy5yZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaCh0aGlzLmRlbChrZXksIHN0b3JlTmFtZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBQcm9taXNlLmFsbChwcm9taXNlcykudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBNZXRhIGluZm9ybWF0aW9uIGFib3V0IGEgY2FjaGUgZW50cnlcclxuICovXHJcbnR5cGUgQ2FjaGVNZXRhID0ge1xyXG4gICAgc2l6ZTogbnVtYmVyO1xyXG4gICAgZGF0ZUFjY2Vzc2VkOiBzdHJpbmc7XHJcbn07XHJcblxyXG4vKipcclxuICogSGFuZGxlcyBjYWNoaW5nIGZvciBQREZzXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUERGQ2FjaGUge1xyXG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJTdGF0aWMgUHJvcGVydGllc1wiPlxyXG4gICAgLyoqXHJcbiAgICAgKiBNYXggc2l6ZSBvZiB0aGUgY2FjaGUsIGRlZmF1bHRzIHRvIDI1NiBNQi5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXQgTUFYX0JZVEVTKCkge1xyXG4gICAgICAgIHJldHVybiBnYW1lLnNldHRpbmdzLmdldChQREZTZXR0aW5ncy5FWFRFUk5BTF9TWVNURU1fTkFNRSwgJ0NhY2hlU2l6ZScpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IElEQl9OQU1FOiBzdHJpbmcgPSAnUERGb3VuZHJ5JztcclxuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IElEQl9WRVJTSU9OOiBudW1iZXIgPSAxO1xyXG5cclxuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IENBQ0hFOiBzdHJpbmcgPSBgQ2FjaGVgO1xyXG4gICAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgTUVUQTogc3RyaW5nID0gYE1ldGFgO1xyXG5cclxuICAgIHByaXZhdGUgc3RhdGljIF9jYWNoZUhlbHBlcjogSURCSGVscGVyO1xyXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIGluaXRpYWxpemUoKSB7XHJcbiAgICAgICAgUERGQ2FjaGUuX2NhY2hlSGVscGVyID0gYXdhaXQgSURCSGVscGVyLmNyZWF0ZUFuZE9wZW4oUERGQ2FjaGUuSURCX05BTUUsIFtQREZDYWNoZS5DQUNIRSwgUERGQ2FjaGUuTUVUQV0sIFBERkNhY2hlLklEQl9WRVJTSU9OKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIGdldE1ldGEoa2V5OiBzdHJpbmcpOiBQcm9taXNlPENhY2hlTWV0YSB8IG51bGw+IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgUERGQ2FjaGUuX2NhY2hlSGVscGVyLmdldChrZXksIFBERkNhY2hlLk1FVEEpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIHNldE1ldGEoa2V5OiBzdHJpbmcsIG1ldGE6IENhY2hlTWV0YSk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICAgIGF3YWl0IFBERkNhY2hlLl9jYWNoZUhlbHBlci5zZXQoa2V5LCBtZXRhLCBQREZDYWNoZS5NRVRBLCB0cnVlKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIGdldENhY2hlKGtleTogc3RyaW5nKTogUHJvbWlzZTxVaW50OEFycmF5IHwgbnVsbD4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ5dGVzID0gYXdhaXQgUERGQ2FjaGUuX2NhY2hlSGVscGVyLmdldChrZXksIFBERkNhY2hlLkNBQ0hFKTtcclxuICAgICAgICAgICAgY29uc3QgbWV0YTogQ2FjaGVNZXRhID0ge1xyXG4gICAgICAgICAgICAgICAgZGF0ZUFjY2Vzc2VkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICBzaXplOiBieXRlcy5sZW5ndGgsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGF3YWl0IFBERkNhY2hlLnNldE1ldGEoa2V5LCBtZXRhKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBieXRlcztcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBzZXRDYWNoZShrZXk6IHN0cmluZywgYnl0ZXM6IFVpbnQ4QXJyYXkpIHtcclxuICAgICAgICBQREZMb2cud2FybihgQ2FjaGVkIGRhdGEgZm9yICR7a2V5fWApO1xyXG4gICAgICAgIGNvbnN0IG1ldGE6IENhY2hlTWV0YSA9IHtcclxuICAgICAgICAgICAgZGF0ZUFjY2Vzc2VkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgIHNpemU6IGJ5dGVzLmxlbmd0aCxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBhd2FpdCBQREZDYWNoZS5fY2FjaGVIZWxwZXIuc2V0KGtleSwgYnl0ZXMsIFBERkNhY2hlLkNBQ0hFLCB0cnVlKTtcclxuICAgICAgICBhd2FpdCBQREZDYWNoZS5zZXRNZXRhKGtleSwgbWV0YSk7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5wcnVuZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc3RhdGljIGFzeW5jIHBydW5lKCkge1xyXG4gICAgICAgIGNvbnN0IGtleXMgPSBhd2FpdCB0aGlzLl9jYWNoZUhlbHBlci5rZXlzKFBERkNhY2hlLk1FVEEpO1xyXG5cclxuICAgICAgICBsZXQgdG90YWxCeXRlcyA9IDA7XHJcbiAgICAgICAgbGV0IG1ldGFzOiBhbnlbXSA9IFtdO1xyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIGtleXMpIHtcclxuICAgICAgICAgICAgY29uc3QgbWV0YSA9IGF3YWl0IHRoaXMuX2NhY2hlSGVscGVyLmdldChrZXksIFBERkNhY2hlLk1FVEEpO1xyXG4gICAgICAgICAgICBtZXRhLmRhdGVBY2Nlc3NlZCA9IERhdGUucGFyc2UobWV0YS5kYXRlQWNjZXNzZWQpO1xyXG4gICAgICAgICAgICBtZXRhLnNpemUgPSBwYXJzZUludChtZXRhLnNpemUpO1xyXG5cclxuICAgICAgICAgICAgdG90YWxCeXRlcyArPSBtZXRhLnNpemU7XHJcblxyXG4gICAgICAgICAgICBtZXRhcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGtleSxcclxuICAgICAgICAgICAgICAgIG1ldGEsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbWV0YXMgPSBtZXRhcy5zb3J0KChhLCBiKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiBhLm1ldGEuZGF0ZUFjY2Vzc2VkIC0gYi5tZXRhLmRhdGVBY2Nlc3NlZDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtZXRhcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAodG90YWxCeXRlcyA8IFBERkNhY2hlLk1BWF9CWVRFUykge1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG5leHQgPSBtZXRhc1tpXTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuX2NhY2hlSGVscGVyLmRlbChuZXh0LmtleSwgUERGQ2FjaGUuTUVUQSk7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuX2NhY2hlSGVscGVyLmRlbChuZXh0LmtleSwgUERGQ2FjaGUuQ0FDSEUpO1xyXG5cclxuICAgICAgICAgICAgdG90YWxCeXRlcyAtPSBuZXh0Lm1ldGEuc2l6ZTtcclxuXHJcbiAgICAgICAgICAgIFBERkxvZy53YXJuKGBQcnVuZWQgJHtuZXh0Lm1ldGEuc2l6ZX0gYnl0ZXMgYnkgZGVsZXRpbmcgJHtuZXh0LmtleX1gKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyByZWdpc3RlclNldHRpbmdzKCkge1xyXG4gICAgICAgIGdhbWUuc2V0dGluZ3MucmVnaXN0ZXIoUERGU2V0dGluZ3MuRVhURVJOQUxfU1lTVEVNX05BTUUsICdDYWNoZVNpemUnLCB7XHJcbiAgICAgICAgICAgIG5hbWU6IGdhbWUuaTE4bi5sb2NhbGl6ZSgnUERGT1VORFJZLlNFVFRJTkdTLkNhY2hlU2l6ZU5hbWUnKSxcclxuICAgICAgICAgICAgc2NvcGU6ICd1c2VyJyxcclxuICAgICAgICAgICAgdHlwZTogTnVtYmVyLFxyXG4gICAgICAgICAgICBoaW50OiBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5TRVRUSU5HUy5DYWNoZVNpemVIaW50JyksXHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IDI1NiAqIDIgKiogMjAsIC8vIDI1NiBNQlxyXG4gICAgICAgICAgICBjb25maWc6IHRydWUsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIHB1YmxpYyBzdGF0aWMgZ2V0T3JGZXRjaChrZXk6IHN0cmluZyk6IFByb21pc2U8VWludDhBcnJheSB8IG51bGw+IHtcclxuLy8gICAgIHJldHVybiBuZXcgUHJvbWlzZTxVaW50OEFycmF5Pihhc3luYyAocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbi8vICAgICAgICAgY29uc3QgY2FjaGVkQnl0ZXMgPSBhd2FpdCBQREZDYWNoZS5nZXRDYWNoZShrZXkpO1xyXG4vLyAgICAgICAgIGlmIChjYWNoZWRCeXRlcyAhPT0gbnVsbCAmJiBjYWNoZWRCeXRlcy5ieXRlTGVuZ3RoID4gMCkge1xyXG4vLyAgICAgICAgICAgICByZXNvbHZlKGNhY2hlZEJ5dGVzKTtcclxuLy8gICAgICAgICAgICAgcmV0dXJuO1xyXG4vLyAgICAgICAgIH1cclxuLy9cclxuLy8gICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGtleSk7XHJcbi8vICAgICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7XHJcbi8vICAgICAgICAgICAgIGNvbnN0IGZldGNoZWRCeXRlcyA9IG5ldyBVaW50OEFycmF5KGF3YWl0IHJlc3BvbnNlLmFycmF5QnVmZmVyKCkpO1xyXG4vLyAgICAgICAgICAgICBpZiAoZmV0Y2hlZEJ5dGVzLmJ5dGVMZW5ndGggPiAwKSB7XHJcbi8vICAgICAgICAgICAgICAgICBhd2FpdCBQREZDYWNoZS5zZXRDYWNoZShrZXksIGZldGNoZWRCeXRlcyk7XHJcbi8vICAgICAgICAgICAgICAgICByZXNvbHZlKGZldGNoZWRCeXRlcyk7XHJcbi8vICAgICAgICAgICAgICAgICByZXR1cm47XHJcbi8vICAgICAgICAgICAgIH0gZWxzZSB7XHJcbi8vICAgICAgICAgICAgICAgICByZWplY3QoJ0NhY2hlICYgZmV0Y2ggYm90aCBmYWlsZWQuJyk7XHJcbi8vICAgICAgICAgICAgIH1cclxuLy8gICAgICAgICB9IGVsc2Uge1xyXG4vLyAgICAgICAgICAgICByZWplY3QoJ0NhY2hlICYgZmV0Y2ggYm90aCBmYWlsZWQuJyk7XHJcbi8vICAgICAgICAgfVxyXG4vLyAgICAgfSk7XHJcbi8vIH1cclxuIiwiLyogQ29weXJpZ2h0IDIwMjAgQW5kcmV3IEN1Y2NpbmVsbG9cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgUERGTG9nIH0gZnJvbSAnLi4vbG9nL1BERkxvZyc7XHJcblxyXG50eXBlIFBERlNldHVwRXZlbnQgPSAnaW5pdCcgfCAnc2V0dXAnIHwgJ3JlYWR5JztcclxuXHJcbnR5cGUgUERGVmlld2VyRXZlbnQgPSAndmlld2VyT3BlbicgfCAndmlld2VyQ2xvc2UnIHwgJ3ZpZXdlclJlYWR5JztcclxuXHJcbmV4cG9ydCB0eXBlIFBERkV2ZW50ID0gUERGU2V0dXBFdmVudCB8IFBERlZpZXdlckV2ZW50O1xyXG5cclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5jbGFzcyBFdmVudFN0b3JlIHtcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgX25hbWU6IFBERkV2ZW50O1xyXG4gICAgcHJpdmF0ZSByZWFkb25seSBfY2FsbGJhY2tzOiBGdW5jdGlvbltdO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKG5hbWU6IFBERkV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5fbmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5fY2FsbGJhY2tzID0gW107XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUdXJuIG9uIGFuIGV2ZW50IGNhbGxiYWNrIGZvciB0aGlzIGV2ZW50LlxyXG4gICAgICogQHBhcmFtIGNhbGxiYWNrIFRoZSBjYWxsYmFjayB0byB0dXJuIG9uXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBvbihjYWxsYmFjazogRnVuY3Rpb24pIHtcclxuICAgICAgICBpZiAodGhpcy5fY2FsbGJhY2tzID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLl9jYWxsYmFja3MubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2NhbGxiYWNrc1tpXSA9PT0gY2FsbGJhY2spIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuX2NhbGxiYWNrcy5wdXNoKGNhbGxiYWNrKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFR1cm4gb2ZmIGFuIGV2ZW50IGNhbGxiYWNrIGZvciB0aGlzIGV2ZW50LlxyXG4gICAgICogQHBhcmFtIGNhbGxiYWNrIFRoZSBjYWxsYmFjayB0byB0dXJuIG9mZlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgb2ZmKGNhbGxiYWNrOiBGdW5jdGlvbikge1xyXG4gICAgICAgIGlmICh0aGlzLl9jYWxsYmFja3MgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gdGhpcy5fY2FsbGJhY2tzLmxlbmd0aDsgaSA+PSAwOyBpLS0pIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2NhbGxiYWNrc1tpXSA9PT0gY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NhbGxiYWNrcy5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBGaXJlIGFuIGV2ZW50IGFuZCBmb3J3YXJkIHRoZSBhcmdzIHRvIGFsbCBoYW5kbGVyc1xyXG4gICAgICogQHBhcmFtIGFyZ3MgQW55IGFyZ3VtZW50cyB0aGF0IHNob3VsZCBiZSBwYXNzZWQgdG8gaGFuZGxlcnNcclxuICAgICAqL1xyXG4gICAgcHVibGljIGZpcmUoLi4uYXJncykge1xyXG4gICAgICAgIGlmIChQREZFdmVudHMuREVCVUcpIHtcclxuICAgICAgICAgICAgUERGTG9nLmxvZyhgPCR7dGhpcy5fbmFtZX0+YCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGFyZ3MpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBjYiBvZiB0aGlzLl9jYWxsYmFja3MpIHtcclxuICAgICAgICAgICAgY2IoLi4uYXJncyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogVHJhY2tzIGFuZCBwdWJsaXNoZXMgZXZlbnRzIGZvciBQREYgcmVsYXRlZCBvY2N1cnJlbmNlcy5cclxuICogVGhpcyBjbGFzcyBpcyBjYWxsYWJsZSB0aHJvdWdoIGB1aS5QREZvdW5kcnkuZXZlbnRzYFxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFBERkV2ZW50cyB7XHJcbiAgICAvKipcclxuICAgICAqIFNob3VsZCBldmVyeSBldmVudCBjYWxsJ3MgZXZlbnQgbmFtZSBhbmQgYXJndW1lbnRzIGJlIGxvZ2dlZD9cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBERUJVRzogYm9vbGVhbiA9IHRydWU7XHJcblxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgX0VWRU5UUyA9IHtcclxuICAgICAgICBpbml0OiBuZXcgRXZlbnRTdG9yZSgnaW5pdCcpLFxyXG4gICAgICAgIHNldHVwOiBuZXcgRXZlbnRTdG9yZSgnc2V0dXAnKSxcclxuICAgICAgICByZWFkeTogbmV3IEV2ZW50U3RvcmUoJ3JlYWR5JyksXHJcblxyXG4gICAgICAgIHZpZXdlck9wZW46IG5ldyBFdmVudFN0b3JlKCd2aWV3ZXJPcGVuJyksXHJcbiAgICAgICAgdmlld2VyQ2xvc2U6IG5ldyBFdmVudFN0b3JlKCd2aWV3ZXJDbG9zZScpLFxyXG4gICAgICAgIHZpZXdlclJlYWR5OiBuZXcgRXZlbnRTdG9yZSgndmlld2VyUmVhZHknKSxcclxuICAgIH07XHJcblxyXG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJTZXR1cCAmIEluaXRpYWxpemF0aW9uIEV2ZW50c1wiPlxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSGVscGVyIG1ldGhvZCB2ZXJzaW9uIG9mIHtAbGluayBQREZFdmVudHMub259XHJcbiAgICAgKiBDYWxsZWQgd2hlbiBhbGwgUERGb3VuZHJ5IGluaXQgc3RhZ2UgZXZlbnRzIGFyZSBkb25lLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGdldCBpbml0KCkge1xyXG4gICAgICAgIHJldHVybiBQREZFdmVudHMuX0VWRU5UU1snaW5pdCddLm9uO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSGVscGVyIG1ldGhvZCB2ZXJzaW9uIG9mIHtAbGluayBQREZFdmVudHMub259XHJcbiAgICAgKiBDYWxsZWQgd2hlbiBhbGwgUERGb3VuZHJ5IHNldHVwIHN0YWdlIGV2ZW50cyBhcmUgZG9uZS5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXQgc2V0dXAoKSB7XHJcbiAgICAgICAgcmV0dXJuIFBERkV2ZW50cy5fRVZFTlRTWydzZXR1cCddLm9uO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSGVscGVyIG1ldGhvZCB2ZXJzaW9uIG9mIHtAbGluayBQREZFdmVudHMub259XHJcbiAgICAgKiBDYWxsZWQgd2hlbiBhbGwgUERGb3VuZHJ5IHJlYWR5IHN0YWdlIGV2ZW50cyBhcmUgZG9uZS5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXQgcmVhZHkoKSB7XHJcbiAgICAgICAgcmV0dXJuIFBERkV2ZW50cy5fRVZFTlRTWydyZWFkeSddLm9uO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIDwvZWRpdG9yLWZvbGQ+XHJcblxyXG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJWaWV3ZXIgRXZlbnRzXCI+XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBIZWxwZXIgbWV0aG9kIHZlcnNpb24gb2Yge0BsaW5rIFBERkV2ZW50cy5vbn1cclxuICAgICAqIENhbGxlZCB3aGVuIGEgUERGIHZpZXdlciBiZWdpbnMgb3BlbmluZ1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGdldCB2aWV3ZXJPcGVuKCkge1xyXG4gICAgICAgIHJldHVybiBQREZFdmVudHMuX0VWRU5UU1sndmlld2VyT3BlbiddLm9uO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSGVscGVyIG1ldGhvZCB2ZXJzaW9uIG9mIHtAbGluayBQREZFdmVudHMub259XHJcbiAgICAgKiBDYWxsZWQgd2hlbiBhIFBERiB2aWV3ZXIgYmVnaW5zIGNsb3NpbmdcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXQgdmlld2VyQ2xvc2UoKSB7XHJcbiAgICAgICAgcmV0dXJuIFBERkV2ZW50cy5fRVZFTlRTWyd2aWV3ZXJDbG9zZSddLm9uO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSGVscGVyIG1ldGhvZCB2ZXJzaW9uIG9mIHtAbGluayBQREZFdmVudHMub259XHJcbiAgICAgKiBDYWxsZWQgd2hlbiBhIFBERiB2aWV3ZXIgaXMgcmVhZHkgdG8gdXNlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0IHZpZXdlclJlYWR5KCkge1xyXG4gICAgICAgIHJldHVybiBQREZFdmVudHMuX0VWRU5UU1sndmlld2VyUmVhZHknXS5vbjtcclxuICAgIH1cclxuXHJcbiAgICAvLyA8L2VkaXRvci1mb2xkPlxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTGlrZSBAc2VlIHtAbGluayBQREZFdmVudHMub259IGJ1dCBmaXJlcyB0aGUgZXZlbnQgb25seSBvbmNlLCB0aGVuIGNhbGxzIG9mZi5cclxuICAgICAqIEBwYXJhbSBldmVudFxyXG4gICAgICogQHBhcmFtIGNhbGxiYWNrXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgb25jZShldmVudDogUERGRXZlbnQsIGNhbGxiYWNrOiBGdW5jdGlvbikge1xyXG4gICAgICAgIGNvbnN0IHdyYXBwZXIgPSBmdW5jdGlvbiAoLi4uYXJncykge1xyXG4gICAgICAgICAgICBjYWxsYmFjayhhcmdzKTtcclxuICAgICAgICAgICAgUERGRXZlbnRzLm9mZihldmVudCwgd3JhcHBlcik7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBQREZFdmVudHMub24oZXZlbnQsIHdyYXBwZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVHVybiBvbiBhbiBldmVudCBjYWxsYmFjayBmb3IgYW4gZXZlbnQuXHJcbiAgICAgKiBAcGFyYW0gZXZlbnQgVGhlIG5hbWUgb2YgdGhlIGV2ZW50XHJcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2sgVGhlIGNhbGxiYWNrIHRvIHR1cm4gb25cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBvbihldmVudDogUERGRXZlbnQsIGNhbGxiYWNrOiBGdW5jdGlvbikge1xyXG4gICAgICAgIFBERkV2ZW50cy5fRVZFTlRTW2V2ZW50XS5vbihjYWxsYmFjayk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUdXJuIG9mZiBhbiBldmVudCBjYWxsYmFjayBmb3IgYW4gZXZlbnQuXHJcbiAgICAgKiBAcGFyYW0gZXZlbnQgVGhlIG5hbWUgb2YgdGhlIGV2ZW50XHJcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2sgVGhlIGNhbGxiYWNrIHRvIHR1cm4gb2ZmXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgb2ZmKGV2ZW50OiBQREZFdmVudCwgY2FsbGJhY2s6IEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgUERGRXZlbnRzLl9FVkVOVFNbZXZlbnRdLm9mZihjYWxsYmFjayk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBmaXJlKGV2ZW50OiBQREZFdmVudCwgLi4uYXJncykge1xyXG4gICAgICAgIGlmIChQREZFdmVudHMuREVCVUcpIHtcclxuICAgICAgICAgICAgUERGTG9nLnZlcmJvc2UoYEZpcmluZyBFdmVudDogJHtldmVudH1gKTtcclxuICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhhcmdzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgUERGRXZlbnRzLl9FVkVOVFNbZXZlbnRdLmZpcmUoYXJncyk7XHJcbiAgICB9XHJcbn1cclxuIiwiLyogQ29weXJpZ2h0IDIwMjAgQW5kcmV3IEN1Y2NpbmVsbG9cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5cclxudHlwZSBDb25zb2xlTWVzc2FnZSA9IG9iamVjdCB8IHN0cmluZyB8IG51bWJlciB8IG51bGw7XHJcbnR5cGUgTG9nVHlwZSA9ICdsb2cnIHwgJ3dhcm4nIHwgJ2Vycm9yJyB8ICd2ZXJib3NlJztcclxuXHJcbi8qKlxyXG4gKiBBIGNvbnNvbGUgbG9nZ2luZyB3cmFwcGVyIHRoYXQgaW5jbHVkZXMgc29tZSBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXHJcbiAqICB3aXRoIG91dHB1dCB0byBoZWxwIGZpbHRlciBtZXNzYWdlcyBlYXNpZXIuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUERGTG9nIHtcclxuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgUFJFRklYOiBzdHJpbmcgPSAnUERGb3VuZHJ5JztcclxuXHJcbiAgICBwcml2YXRlIHN0YXRpYyBmb3JtYXQobWVzc2FnZTogQ29uc29sZU1lc3NhZ2UpIHtcclxuICAgICAgICBjb25zdCB0aW1lID0gbmV3IERhdGUoKTtcclxuXHJcbiAgICAgICAgY29uc3QgcGFkID0gKG46IG51bWJlcikgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gbiA+PSAxMCA/IG4gOiBgMCR7bn1gO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uc3QgcGFkX21zID0gKG46IG51bWJlcikgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBzID0gbi50b1N0cmluZygpO1xyXG4gICAgICAgICAgICByZXR1cm4gJzAwMDAnLnN1YnN0cmluZygwLCA0IC0gcy5sZW5ndGgpICsgcztcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjb25zdCBoaCA9IHBhZCh0aW1lLmdldEhvdXJzKCkpO1xyXG4gICAgICAgIGNvbnN0IG1tID0gcGFkKHRpbWUuZ2V0TWludXRlcygpKTtcclxuICAgICAgICBjb25zdCBzcyA9IHBhZCh0aW1lLmdldFNlY29uZHMoKSk7XHJcbiAgICAgICAgY29uc3QgbXMgPSBwYWRfbXModGltZS5nZXRNaWxsaXNlY29uZHMoKSk7XHJcblxyXG4gICAgICAgIHJldHVybiBgWyR7UERGTG9nLlBSRUZJWH1AJHtoaH06JHttbX06JHtzc30uJHttc31dICR7bWVzc2FnZX1gO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU25hcHNob3QgYW4gb2JqZWN0IHRvIHByZXNlcnZlIGl0J3MgQ1VSUkVOVCBzdGF0ZSBpbiBjb25zb2xlXHJcbiAgICAgKiBPdGhlcndpc2UgY29uc29sZXMgJ2xhenkgbG9hZCcgb2JqZWN0cywgYW5kIGl0IGlzIHZlcnkgaGFyZFxyXG4gICAgICogIHRvIGluc3BlY3QgdGhlaXIgdmFsdWVzIHdoZW4gdGhleSB3ZXJlIHByaW50ZWQgKHNhbnMgYnJlYWtwb2ludHMpXHJcbiAgICAgKiBAcGFyYW0gdmFsdWUgVGhlIG9iamVjdCB0byBzbmFwc2hvdFxyXG4gICAgICogQHBhcmFtIGxldmVsIFdoYXQgbG9nZ2luZyBsZXZlbCBzaG91bGQgYmUgdXNlZFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIHNuYXBzaG90KHZhbHVlOiBvYmplY3QsIGxldmVsOiBMb2dUeXBlID0gJ2xvZycpIHtcclxuICAgICAgICBjb25zdCBzbmFwID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh2YWx1ZSkpO1xyXG4gICAgICAgIGxldCBmbjogRnVuY3Rpb247XHJcblxyXG4gICAgICAgIHN3aXRjaCAobGV2ZWwpIHtcclxuICAgICAgICAgICAgY2FzZSAnbG9nJzpcclxuICAgICAgICAgICAgICAgIGZuID0gY29uc29sZS5sb2c7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnd2Fybic6XHJcbiAgICAgICAgICAgICAgICBmbiA9IGNvbnNvbGUud2FybjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdlcnJvcic6XHJcbiAgICAgICAgICAgICAgICBmbiA9IGNvbnNvbGUuZXJyb3I7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAndmVyYm9zZSc6XHJcbiAgICAgICAgICAgICAgICBmbiA9IGNvbnNvbGUuZGVidWc7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZuKFBERkxvZy5mb3JtYXQoJzo6IEZyb3plbiBPYmplY3QgOjonKSk7XHJcbiAgICAgICAgZm4oc25hcCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQcmludCBhIGxvZyBsZXZlbCBtZXNzYWdlIHRvIGNvbnNvbGUuXHJcbiAgICAgKiBAcGFyYW0gbWVzc2FnZSBUaGUgbWVzc2FnZSB0byBwcmludC5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBsb2cobWVzc2FnZTogQ29uc29sZU1lc3NhZ2UpIHtcclxuICAgICAgICBpZiAodHlwZW9mIG1lc3NhZ2UgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBtZXNzYWdlID09PSAnbnVtYmVyJykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhQREZMb2cuZm9ybWF0KG1lc3NhZ2UpKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhQREZMb2cuZm9ybWF0KCc6OiBMaXZlIE9iamVjdCA6OicpKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJpbnQgYW4gaW5mbyBsZXZlbCBtZXNzYWdlIHRvIGNvbnNvbGUuXHJcbiAgICAgKiBAcGFyYW0gbWVzc2FnZSBUaGUgbWVzc2FnZSB0byBwcmludC5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBpbmZvKG1lc3NhZ2U6IENvbnNvbGVNZXNzYWdlKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBtZXNzYWdlID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgbWVzc2FnZSA9PT0gJ251bWJlcicpIHtcclxuICAgICAgICAgICAgY29uc29sZS5pbmZvKFBERkxvZy5mb3JtYXQobWVzc2FnZSkpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhQREZMb2cuZm9ybWF0KCc6OiBMaXZlIE9iamVjdCA6OicpKTtcclxuICAgICAgICAgICAgY29uc29sZS5pbmZvKG1lc3NhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaW50IGEgdmVyYm9zZSBsZXZlbCBtZXNzYWdlIHRvIGNvbnNvbGUuXHJcbiAgICAgKiBAcGFyYW0gbWVzc2FnZSBUaGUgbWVzc2FnZSB0byBwcmludC5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyB2ZXJib3NlKG1lc3NhZ2U6IENvbnNvbGVNZXNzYWdlKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBtZXNzYWdlID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgbWVzc2FnZSA9PT0gJ251bWJlcicpIHtcclxuICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhQREZMb2cuZm9ybWF0KG1lc3NhZ2UpKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKFBERkxvZy5mb3JtYXQoJzo6IExpdmUgT2JqZWN0IDo6JykpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKG1lc3NhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaW50IGEgd2FybmluZyBsZXZlbCBtZXNzYWdlIHRvIGNvbnNvbGUuXHJcbiAgICAgKiBAcGFyYW0gbWVzc2FnZSBUaGUgbWVzc2FnZSB0byBwcmludC5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyB3YXJuKG1lc3NhZ2U6IENvbnNvbGVNZXNzYWdlKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBtZXNzYWdlID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgbWVzc2FnZSA9PT0gJ251bWJlcicpIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKFBERkxvZy5mb3JtYXQobWVzc2FnZSkpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihQREZMb2cuZm9ybWF0KCc6OiBMaXZlIE9iamVjdCA6OicpKTtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKG1lc3NhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaW50IGEgZXJyb3IgbGV2ZWwgbWVzc2FnZSB0byBjb25zb2xlLlxyXG4gICAgICogQHBhcmFtIG1lc3NhZ2UgVGhlIG1lc3NhZ2UgdG8gcHJpbnQuXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgZXJyb3IobWVzc2FnZTogQ29uc29sZU1lc3NhZ2UpIHtcclxuICAgICAgICBpZiAodHlwZW9mIG1lc3NhZ2UgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBtZXNzYWdlID09PSAnbnVtYmVyJykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFBERkxvZy5mb3JtYXQobWVzc2FnZSkpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoUERGTG9nLmZvcm1hdCgnOjogTGl2ZSBPYmplY3QgOjonKSk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IobWVzc2FnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiIsIi8qIENvcHlyaWdodCAyMDIwIEFuZHJldyBDdWNjaW5lbGxvXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFBERlNldHVwIH0gZnJvbSAnLi9zZXR1cC9QREZTZXR1cCc7XHJcbmltcG9ydCB7IFBERkNhY2hlIH0gZnJvbSAnLi9jYWNoZS9QREZDYWNoZSc7XHJcbmltcG9ydCB7IFBERkV2ZW50cyB9IGZyb20gJy4vZXZlbnRzL1BERkV2ZW50cyc7XHJcbmltcG9ydCB7IFBERkkxOG4gfSBmcm9tICcuL3NldHRpbmdzL1BERkkxOG4nO1xyXG5pbXBvcnQgeyBQREZTZXR0aW5ncyB9IGZyb20gJy4vc2V0dGluZ3MvUERGU2V0dGluZ3MnO1xyXG5pbXBvcnQgeyBQREZMb2cgfSBmcm9tICcuL2xvZy9QREZMb2cnO1xyXG5pbXBvcnQgeyBQREZTZXRWaWV3RXZlbnQgfSBmcm9tICcuL3NvY2tldC9ldmVudHMvUERGU2V0Vmlld0V2ZW50JztcclxuaW1wb3J0IHsgUERGU29ja2V0SGFuZGxlciB9IGZyb20gJy4vc29ja2V0L1BERlNvY2tldEhhbmRsZXInO1xyXG5cclxuQ09ORklHLmRlYnVnLmhvb2tzID0gdHJ1ZTtcclxuXHJcblBERlNldHVwLnJlZ2lzdGVyU3lzdGVtKCk7XHJcblxyXG5jb25zdCBpbml0ID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgLy8gUmVnaXN0ZXIgdGhlIEFQSSBvbiB0aGUgdWkgb2JqZWN0XHJcbiAgICBQREZTZXR1cC5yZWdpc3RlckFQSSgpO1xyXG4gICAgLy8gSW5qZWN0IHRoZSBjc3MgaW50byB0aGUgcGFnZVxyXG4gICAgUERGU2V0dXAucmVnaXN0ZXJDU1MoKTtcclxuXHJcbiAgICBQREZFdmVudHMuZmlyZSgnaW5pdCcpO1xyXG5cclxuICAgIGF3YWl0IHNldHVwKCk7XHJcbn07XHJcbmNvbnN0IHNldHVwID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgLy8gSW5pdGlhbGl6ZSB0aGUgY2FjaGUgc3lzdGVtLCBjcmVhdGluZyB0aGUgREJcclxuICAgIGF3YWl0IFBERkNhY2hlLmluaXRpYWxpemUoKTtcclxuICAgIC8vIExvYWQgdGhlIHJlbGV2YW50IGludGVybmF0aW9uYWxpemF0aW9uIGZpbGUuXHJcbiAgICBhd2FpdCBQREZJMThuLmluaXRpYWxpemUoKTtcclxuXHJcbiAgICBQREZFdmVudHMuZmlyZSgnc2V0dXAnKTtcclxuXHJcbiAgICBhd2FpdCByZWFkeSgpO1xyXG59O1xyXG5jb25zdCByZWFkeSA9IGFzeW5jICgpID0+IHtcclxuICAgIC8vIFJlZ2lzdGVyIHRoZSBQREYgc2hlZXQgd2l0aCB0aGUgY2xhc3MgcGlja2VyLCB1bnJlZ2lzdGVyIG90aGVyc1xyXG4gICAgUERGU2V0dXAucmVnaXN0ZXJQREZTaGVldCgpO1xyXG4gICAgLy8gSW5pdGlhbGl6ZSB0aGUgc2V0dGluZ3NcclxuICAgIGF3YWl0IFBERlNldHRpbmdzLnJlZ2lzdGVyU2V0dGluZ3MoKTtcclxuXHJcbiAgICBQREZTZXR1cC51c2VyTG9naW4oKTtcclxuXHJcbiAgICBQREZTb2NrZXRIYW5kbGVyLnJlZ2lzdGVySGFuZGxlcnMoKTtcclxuXHJcbiAgICBQREZFdmVudHMuZmlyZSgncmVhZHknKTtcclxufTtcclxuXHJcbkhvb2tzLm9uY2UoJ2luaXQnLCBpbml0KTtcclxuXHJcbi8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiUGVyc2lzdGVudCBIb29rc1wiPlxyXG5cclxuLy8gcHJlQ3JlYXRlSXRlbSAtIFNldHVwIGRlZmF1bHQgdmFsdWVzIGZvciBhIG5ldyBQREZvdW5kcnlfUERGXHJcbkhvb2tzLm9uKCdwcmVDcmVhdGVJdGVtJywgUERGU2V0dGluZ3MucHJlQ3JlYXRlSXRlbSk7XHJcbi8vIGdldEl0ZW1EaXJlY3RvcnlFbnRyeUNvbnRleHQgLSBTZXR1cCBjb250ZXh0IG1lbnUgZm9yICdPcGVuIFBERicgbGlua3NcclxuSG9va3Mub24oJ2dldEl0ZW1EaXJlY3RvcnlFbnRyeUNvbnRleHQnLCBQREZTZXR0aW5ncy5nZXRJdGVtQ29udGV4dE9wdGlvbnMpO1xyXG4vLyByZW5kZXJTZXR0aW5ncyAtIEluamVjdCBhICdPcGVuIE1hbnVhbCcgYnV0dG9uIGludG8gaGVscCBzZWN0aW9uXHJcbkhvb2tzLm9uKCdyZW5kZXJTZXR0aW5ncycsIFBERlNldHRpbmdzLm9uUmVuZGVyU2V0dGluZ3MpO1xyXG5cclxuLy8gPC9lZGl0b3ItZm9sZD5cclxuIiwiLyogQ29weXJpZ2h0IDIwMjAgQW5kcmV3IEN1Y2NpbmVsbG9cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgUERGU2V0dGluZ3MgfSBmcm9tICcuL1BERlNldHRpbmdzJztcclxuXHJcbi8qKlxyXG4gKiBMb2NhbGl6YXRpb24gaGVscGVyXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUERGSTE4biB7XHJcbiAgICAvKipcclxuICAgICAqIExvYWQgdGhlIGxvY2FsaXphdGlvbiBmaWxlIGZvciB0aGUgdXNlcidzIGxhbmd1YWdlLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIGluaXRpYWxpemUoKSB7XHJcbiAgICAgICAgY29uc3QgbGFuZyA9IGdhbWUuaTE4bi5sYW5nO1xyXG4gICAgICAgIC8vIHVzZXIncyBsYW5ndWFnZSBwYXRoXHJcbiAgICAgICAgY29uc3QgdV9wYXRoID0gYHN5c3RlbXMvJHtQREZTZXR0aW5ncy5FWFRFUk5BTF9TWVNURU1fTkFNRX0vJHtQREZTZXR0aW5ncy5ESVNUX0ZPTERFUn0vbG9jYWxlLyR7bGFuZ30vY29uZmlnLmpzb25gO1xyXG4gICAgICAgIC8vIGVuZ2xpc2ggZmFsbGJhY2sgcGF0aFxyXG4gICAgICAgIGNvbnN0IGZfcGF0aCA9IGBzeXN0ZW1zLyR7UERGU2V0dGluZ3MuRVhURVJOQUxfU1lTVEVNX05BTUV9LyR7UERGU2V0dGluZ3MuRElTVF9GT0xERVJ9L2xvY2FsZS9lbi9jb25maWcuanNvbmA7XHJcblxyXG4gICAgICAgIGxldCBqc29uO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGpzb24gPSBhd2FpdCAkLmdldEpTT04odV9wYXRoKTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICAvLyBpZiBubyB0cmFuc2xhdGlvbiBleGl0cyBmb3IgdGhlIHVzZXJzIGxvY2FsZSB0aGUgZmFsbGJhY2tcclxuICAgICAgICAgICAganNvbiA9IGF3YWl0ICQuZ2V0SlNPTihmX3BhdGgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXMoanNvbikpIHtcclxuICAgICAgICAgICAgZ2FtZS5pMThuLnRyYW5zbGF0aW9uc1trZXldID0ganNvbltrZXldO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gc2V0dXAgdGhlIGZhbGxiYWNrIGFzIGVuZ2xpc2ggc28gcGFydGlhbCB0cmFuc2xhdGlvbnMgZG8gbm90IGRpc3BsYXkga2V5c1xyXG4gICAgICAgIGxldCBmYl9qc29uID0gYXdhaXQgJC5nZXRKU09OKGZfcGF0aCk7XHJcbiAgICAgICAgZm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXMoZmJfanNvbikpIHtcclxuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxyXG4gICAgICAgICAgICBnYW1lLmkxOG4uX2ZhbGxiYWNrW2tleV0gPSBqc29uW2tleV07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiIsIi8qIENvcHlyaWdodCAyMDIwIEFuZHJldyBDdWNjaW5lbGxvXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFBERkl0ZW1TaGVldCB9IGZyb20gJy4uL2FwcC9QREZJdGVtU2hlZXQnO1xyXG5pbXBvcnQgeyBQREZvdW5kcnlBUEkgfSBmcm9tICcuLi9hcGkvUERGb3VuZHJ5QVBJJztcclxuaW1wb3J0IHsgUERGTG9nIH0gZnJvbSAnLi4vbG9nL1BERkxvZyc7XHJcbmltcG9ydCB7IFBERkNhY2hlIH0gZnJvbSAnLi4vY2FjaGUvUERGQ2FjaGUnO1xyXG5pbXBvcnQgeyBQREZVdGlsIH0gZnJvbSAnLi4vYXBpL1BERlV0aWwnO1xyXG5cclxuLyoqXHJcbiAqIEludGVybmFsIHNldHRpbmdzIGFuZCBoZWxwZXIgbWV0aG9kcyBmb3IgUERGb3VuZHJ5LlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFBERlNldHRpbmdzIHtcclxuICAgIC8qKlxyXG4gICAgICogQXJlIGZlZWRiYWNrIG5vdGlmaWNhdGlvbnMgZW5hYmxlZD8gRGlzYWJsZSBpZiB5b3Ugd2lzaFxyXG4gICAgICogIHRvIGhhbmRsZSB0aGVtIHlvdXJzZWxmLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIE5PVElGSUNBVElPTlM6IGJvb2xlYW4gPSB0cnVlO1xyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgRElTVF9GT0xERVI6IHN0cmluZyA9ICdwZGZvdW5kcnktZGlzdCc7XHJcbiAgICBwdWJsaWMgc3RhdGljIEVYVEVSTkFMX1NZU1RFTV9OQU1FOiBzdHJpbmcgPSAnLi4vbW9kdWxlcy9wZGZvdW5kcnknO1xyXG4gICAgcHVibGljIHN0YXRpYyBJTlRFUk5BTF9NT0RVTEVfTkFNRTogc3RyaW5nID0gJ3BkZm91bmRyeSc7XHJcbiAgICBwdWJsaWMgc3RhdGljIFBERl9FTlRJVFlfVFlQRTogc3RyaW5nID0gJ1BERm91bmRyeV9QREYnO1xyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgSEVMUF9TRUVOX0tFWTogc3RyaW5nID0gJ0hlbHBTZWVuJztcclxuXHJcbiAgICAvKipcclxuICAgICAqIFNldHVwIGRlZmF1bHQgdmFsdWVzIGZvciBwZGYgZW50aXRpZXNcclxuICAgICAqIEBwYXJhbSBlbnRpdHlcclxuICAgICAqIEBwYXJhbSBhcmdzIGlnbm9yZWQgYXJnc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIHByZUNyZWF0ZUl0ZW0oZW50aXR5LCAuLi5hcmdzKSB7XHJcbiAgICAgICAgUERGTG9nLnZlcmJvc2UoJ1ByZS1jcmVhdGUgaXRlbS4nKTtcclxuICAgICAgICBpZiAoZW50aXR5LnR5cGUgIT09IFBERlNldHRpbmdzLlBERl9FTlRJVFlfVFlQRSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVudGl0eS5pbWcgPSBgc3lzdGVtcy8ke1BERlNldHRpbmdzLkVYVEVSTkFMX1NZU1RFTV9OQU1FfS8ke1BERlNldHRpbmdzLkRJU1RfRk9MREVSfS9hc3NldHMvcGRmX2ljb24uc3ZnYDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEhlbHBlciBtZXRob2QgdG8gZ3JhYiB0aGUgaWQgZnJvbSB0aGUgaHRtbCBvYmplY3QgYW5kIHJldHVybiBhbiBpdGVtXHJcbiAgICAgKiBAcGFyYW0gaHRtbFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHN0YXRpYyBnZXRJdGVtRnJvbUNvbnRleHQoaHRtbDogSlF1ZXJ5PEhUTUxFbGVtZW50Pik6IEl0ZW0ge1xyXG4gICAgICAgIGNvbnN0IGlkID0gaHRtbC5kYXRhKCdlbnRpdHktaWQnKTtcclxuICAgICAgICByZXR1cm4gZ2FtZS5pdGVtcy5nZXQoaWQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IGFkZGl0aW9uYWwgY29udGV4dCBtZW51IGljb25zIGZvciBQREYgaXRlbXNcclxuICAgICAqIEBwYXJhbSBodG1sXHJcbiAgICAgKiBAcGFyYW0gb3B0aW9uc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGdldEl0ZW1Db250ZXh0T3B0aW9ucyhodG1sLCBvcHRpb25zOiBhbnlbXSkge1xyXG4gICAgICAgIFBERkxvZy52ZXJib3NlKCdHZXR0aW5nIGNvbnRleHQgb3B0aW9ucy4nKTtcclxuICAgICAgICBvcHRpb25zLnVuc2hpZnQoe1xyXG4gICAgICAgICAgICBuYW1lOiBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5DT05URVhULk9wZW5QREYnKSxcclxuICAgICAgICAgICAgaWNvbjogJzxpIGNsYXNzPVwiZmFyIGZhLWZpbGUtcGRmXCI+PC9pPicsXHJcbiAgICAgICAgICAgIGNvbmRpdGlvbjogKGVudGl0eUh0bWw6IEpRdWVyeTxIVE1MRWxlbWVudD4pID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBQREZTZXR0aW5ncy5nZXRJdGVtRnJvbUNvbnRleHQoZW50aXR5SHRtbCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS50eXBlICE9PSBQREZTZXR0aW5ncy5QREZfRU5USVRZX1RZUEUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgeyB1cmwgfSA9IGl0ZW0uZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVybCAhPT0gJyc7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoZW50aXR5SHRtbDogSlF1ZXJ5PEhUTUxFbGVtZW50PikgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IFBERlNldHRpbmdzLmdldEl0ZW1Gcm9tQ29udGV4dChlbnRpdHlIdG1sKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBkZiA9IFBERlV0aWwuZ2V0UERGRGF0YUZyb21JdGVtKGl0ZW0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChwZGYgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAvL1RPRE86IEVycm9yIGhhbmRsaW5nXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIFBERm91bmRyeUFQSS5vcGVuUERGKHBkZiwgMSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyByZWdpc3RlclNldHRpbmdzKCkge1xyXG4gICAgICAgIFBERkNhY2hlLnJlZ2lzdGVyU2V0dGluZ3MoKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIG9uUmVuZGVyU2V0dGluZ3Moc2V0dGluZ3M6IGFueSwgaHRtbDogSlF1ZXJ5PEhUTUxFbGVtZW50PiwgZGF0YTogYW55KSB7XHJcbiAgICAgICAgUERGTG9nLnZlcmJvc2UoJ1JlbmRlcmluZyBzZXR0aW5ncy4nKTtcclxuICAgICAgICBjb25zdCBpY29uID0gJzxpIGNsYXNzPVwiZmFyIGZhLWZpbGUtcGRmXCI+PC9pPic7XHJcbiAgICAgICAgY29uc3QgYnV0dG9uID0gJChgPGJ1dHRvbj4ke2ljb259ICR7Z2FtZS5pMThuLmxvY2FsaXplKCdQREZPVU5EUlkuU0VUVElOR1MuT3BlbkhlbHAnKX08L2J1dHRvbj5gKTtcclxuICAgICAgICBidXR0b24ub24oJ2NsaWNrJywgUERGU2V0dGluZ3Muc2hvd0hlbHApO1xyXG5cclxuICAgICAgICBodG1sLmZpbmQoJ2gyJykubGFzdCgpLmJlZm9yZShidXR0b24pO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgYXN5bmMgc2hvd0hlbHAoKSB7XHJcbiAgICAgICAgYXdhaXQgZ2FtZS51c2VyLnNldEZsYWcoUERGU2V0dGluZ3MuSU5URVJOQUxfTU9EVUxFX05BTUUsIFBERlNldHRpbmdzLkhFTFBfU0VFTl9LRVksIHRydWUpO1xyXG5cclxuICAgICAgICByZXR1cm4gUERGb3VuZHJ5QVBJLm9wZW5VUkwoXHJcbiAgICAgICAgICAgIGAke3dpbmRvdy5vcmlnaW59L3N5c3RlbXMvJHtQREZTZXR0aW5ncy5FWFRFUk5BTF9TWVNURU1fTkFNRX0vJHtQREZTZXR0aW5ncy5ESVNUX0ZPTERFUn0vYXNzZXRzL1BERm91bmRyeSBNYW51YWwucGRmYCxcclxuICAgICAgICAgICAgMSxcclxuICAgICAgICAgICAgZmFsc2UsXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG4iLCIvKiBDb3B5cmlnaHQgMjAyMCBBbmRyZXcgQ3VjY2luZWxsb1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcblxyXG5pbXBvcnQgeyBQREZTZXR0aW5ncyB9IGZyb20gJy4uL3NldHRpbmdzL1BERlNldHRpbmdzJztcclxuaW1wb3J0IHsgUERGSXRlbVNoZWV0IH0gZnJvbSAnLi4vYXBwL1BERkl0ZW1TaGVldCc7XHJcbmltcG9ydCB7IFBERm91bmRyeUFQSSB9IGZyb20gJy4uL2FwaS9QREZvdW5kcnlBUEknO1xyXG5pbXBvcnQgeyBQREZMb2cgfSBmcm9tICcuLi9sb2cvUERGTG9nJztcclxuXHJcbi8qKlxyXG4gKiBBIGNvbGxlY3Rpb24gb2YgbWV0aG9kcyB1c2VkIGZvciBzZXR0aW5nIHVwIHRoZSBBUEkgJiBzeXN0ZW0gc3RhdGUuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUERGU2V0dXAge1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZWdpc3RlciB0aGUgUERGb3VuZHJ5IEFQaSBvbiB0aGUgVUlcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyByZWdpc3RlckFQSSgpIHtcclxuICAgICAgICB1aVsnUERGb3VuZHJ5J10gPSBQREZvdW5kcnlBUEk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBJbmplY3QgdGhlIENTUyBmaWxlIGludG8gdGhlIGhlYWRlciwgc28gaXQgZG9lc24ndCBoYXZlIHRvIGJlIHJlZmVyZW5jZWQgaW4gdGhlIHN5c3RlbS5qc29uXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgcmVnaXN0ZXJDU1MoKSB7XHJcbiAgICAgICAgJCgnaGVhZCcpLmFwcGVuZChcclxuICAgICAgICAgICAgJChgPGxpbmsgaHJlZj1cInN5c3RlbXMvJHtQREZTZXR0aW5ncy5FWFRFUk5BTF9TWVNURU1fTkFNRX0vJHtQREZTZXR0aW5ncy5ESVNUX0ZPTERFUn0vYnVuZGxlLmNzc1wiIHJlbD1cInN0eWxlc2hlZXRcIiB0eXBlPVwidGV4dC9jc3NcIiBtZWRpYT1cImFsbFwiPmApLFxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQdWxscyB0aGUgc3lzdGVtIG5hbWUgZnJvbSB0aGUgc2NyaXB0IHRhZ3MuXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgcmVnaXN0ZXJTeXN0ZW0oKSB7XHJcbiAgICAgICAgY29uc3Qgc2NyaXB0cyA9ICQoJ3NjcmlwdCcpO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2NyaXB0cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBzY3JpcHQgPSBzY3JpcHRzLmdldChpKSBhcyBIVE1MU2NyaXB0RWxlbWVudDtcclxuICAgICAgICAgICAgY29uc3QgZm9sZGVycyA9IHNjcmlwdC5zcmMuc3BsaXQoJy8nKTtcclxuICAgICAgICAgICAgY29uc3QgZGlzdElkeCA9IGZvbGRlcnMuaW5kZXhPZihQREZTZXR0aW5ncy5ESVNUX0ZPTERFUik7XHJcbiAgICAgICAgICAgIGlmIChkaXN0SWR4ID09PSAtMSkgY29udGludWU7XHJcblxyXG4gICAgICAgICAgICBpZiAoZm9sZGVyc1tkaXN0SWR4IC0gMV0gPT09ICdwZGZvdW5kcnknKSBicmVhaztcclxuXHJcbiAgICAgICAgICAgIFBERlNldHRpbmdzLkVYVEVSTkFMX1NZU1RFTV9OQU1FID0gZm9sZGVyc1tkaXN0SWR4IC0gMV07XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBQREZMb2cuaW5mbyhgVXNpbmcgJHtQREZTZXR0aW5ncy5FWFRFUk5BTF9TWVNURU1fTkFNRX0gYXMgJ0VYVEVSTkFMX1NZU1RFTV9OQU1FJ2ApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVnaXN0ZXIgdGhlIFBERiBzaGVldCBhbmQgdW5yZWdpc3RlciBpbnZhbGlkIHNoZWV0IHR5cGVzIGZyb20gaXQuXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgcmVnaXN0ZXJQREZTaGVldCgpIHtcclxuICAgICAgICBJdGVtcy5yZWdpc3RlclNoZWV0KFBERlNldHRpbmdzLklOVEVSTkFMX01PRFVMRV9OQU1FLCBQREZJdGVtU2hlZXQsIHtcclxuICAgICAgICAgICAgdHlwZXM6IFtQREZTZXR0aW5ncy5QREZfRU5USVRZX1RZUEVdLFxyXG4gICAgICAgICAgICBtYWtlRGVmYXVsdDogdHJ1ZSxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gVW5yZWdpc3RlciBhbGwgb3RoZXIgaXRlbSBzaGVldHMgZm9yIHRoZSBQREYgZW50aXR5XHJcbiAgICAgICAgY29uc3QgcGRmb3VuZHJ5S2V5ID0gYCR7UERGU2V0dGluZ3MuSU5URVJOQUxfTU9EVUxFX05BTUV9LiR7UERGSXRlbVNoZWV0Lm5hbWV9YDtcclxuICAgICAgICBjb25zdCBzaGVldHMgPSBDT05GSUcuSXRlbS5zaGVldENsYXNzZXNbUERGU2V0dGluZ3MuUERGX0VOVElUWV9UWVBFXTtcclxuICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBPYmplY3Qua2V5cyhzaGVldHMpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNoZWV0ID0gc2hlZXRzW2tleV07XHJcbiAgICAgICAgICAgIC8vIGtlZXAgdGhlIFBERm91bmRyeSBzaGVldFxyXG4gICAgICAgICAgICBpZiAoc2hlZXQuaWQgPT09IHBkZm91bmRyeUtleSkge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIGlkIGlzIE1PRFVMRS5DTEFTU19OQU1FXHJcbiAgICAgICAgICAgIGNvbnN0IFttb2R1bGVdID0gc2hlZXQuaWQuc3BsaXQoJy4nKTtcclxuICAgICAgICAgICAgSXRlbXMudW5yZWdpc3RlclNoZWV0KG1vZHVsZSwgc2hlZXQuY2xzLCB7XHJcbiAgICAgICAgICAgICAgICB0eXBlczogW1BERlNldHRpbmdzLlBERl9FTlRJVFlfVFlQRV0sXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIHVzZXJMb2dpbigpIHtcclxuICAgICAgICBsZXQgdmlld2VkO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHZpZXdlZCA9IGdhbWUudXNlci5nZXRGbGFnKFBERlNldHRpbmdzLklOVEVSTkFMX01PRFVMRV9OQU1FLCBQREZTZXR0aW5ncy5IRUxQX1NFRU5fS0VZKTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICB2aWV3ZWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh2aWV3ZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgUERGU2V0dGluZ3Muc2hvd0hlbHAoKTtcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgeyBQREZMb2cgfSBmcm9tICcuLi9sb2cvUERGTG9nJztcclxuaW1wb3J0IHsgUERGU29ja2V0RXZlbnQgfSBmcm9tICcuL2V2ZW50cy9QREZTb2NrZXRFdmVudCc7XHJcbmltcG9ydCB7IFBERlNldHRpbmdzIH0gZnJvbSAnLi4vc2V0dGluZ3MvUERGU2V0dGluZ3MnO1xyXG5pbXBvcnQgeyBQREZTZXRWaWV3RXZlbnQgfSBmcm9tICcuL2V2ZW50cy9QREZTZXRWaWV3RXZlbnQnO1xyXG5pbXBvcnQgeyBQREZvdW5kcnlBUEkgfSBmcm9tICcuLi9hcGkvUERGb3VuZHJ5QVBJJztcclxuXHJcbmV4cG9ydCBjbGFzcyBQREZTb2NrZXRIYW5kbGVyIHtcclxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0IFNPQ0tFVF9OQU1FKCkge1xyXG4gICAgICAgIHJldHVybiBgc3lzdGVtLiR7UERGU2V0dGluZ3MuRVhURVJOQUxfU1lTVEVNX05BTUV9YDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIHJlZ2lzdGVySGFuZGxlcnMoKSB7XHJcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxyXG4gICAgICAgIGdhbWUuc29ja2V0Lm9uKFBERlNvY2tldEhhbmRsZXIuU09DS0VUX05BTUUsIChldmVudCkgPT4ge1xyXG4gICAgICAgICAgICBQREZMb2cud2FybihgSW5jb21pbmcgRXZlbnQ6ICR7ZXZlbnQudHlwZX1gKTtcclxuICAgICAgICAgICAgUERGTG9nLndhcm4oZXZlbnQpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgeyB1c2VySWRzLCB0eXBlLCBwYXlsb2FkIH0gPSBldmVudDtcclxuICAgICAgICAgICAgLy8gbnVsbCA9IGFsbCB1c2Vycywgb3RoZXJ3aXNlIGNoZWNrIGlmIHRoaXMgZXZlbnQgZWZmZWN0cyB1c1xyXG4gICAgICAgICAgICBpZiAodXNlcklkcyAhPT0gbnVsbCAmJiAhdXNlcklkcy5pbmNsdWRlcyhnYW1lLnVzZXJJZCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHR5cGUgPT09IFBERlNldFZpZXdFdmVudC5FVkVOVF9UWVBFKSB7XHJcbiAgICAgICAgICAgICAgICBQREZTb2NrZXRIYW5kbGVyLmhhbmRsZVNldFZpZXcocGF5bG9hZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIGhhbmRsZVNldFZpZXcoZGF0YTogYW55KSB7XHJcbiAgICAgICAgUERGb3VuZHJ5QVBJLm9wZW5QREYoZGF0YS5wZGZEYXRhLCBkYXRhLnBhZ2UpO1xyXG4gICAgfVxyXG59XHJcbiIsIi8qIENvcHlyaWdodCAyMDIwIEFuZHJldyBDdWNjaW5lbGxvXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFBERlNvY2tldEV2ZW50IH0gZnJvbSAnLi9QREZTb2NrZXRFdmVudCc7XHJcbmltcG9ydCB7IFBERkRhdGEgfSBmcm9tICcuLi8uLi90eXBlcy9QREZEYXRhJztcclxuXHJcbmV4cG9ydCBjbGFzcyBQREZTZXRWaWV3RXZlbnQgZXh0ZW5kcyBQREZTb2NrZXRFdmVudCB7XHJcbiAgICBwdWJsaWMgc3RhdGljIGdldCBFVkVOVF9UWVBFKCkge1xyXG4gICAgICAgIHJldHVybiBgJHtzdXBlci5FVkVOVF9UWVBFfS9TRVRfVklFV2A7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHBhZ2U6IG51bWJlcjtcclxuICAgIHB1YmxpYyBwZGZEYXRhOiBQREZEYXRhO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHVzZXJJZHM6IHN0cmluZ1tdfG51bGwsIHBkZkRhdGE6IFBERkRhdGEsIHBhZ2U6IG51bWJlcikge1xyXG4gICAgICAgIHN1cGVyKHVzZXJJZHMpO1xyXG5cclxuICAgICAgICB0aGlzLnBkZkRhdGEgPSBwZGZEYXRhO1xyXG4gICAgICAgIHRoaXMucGFnZSA9IHBhZ2U7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHR5cGUoKSB7XHJcbiAgICAgICAgcmV0dXJuIFBERlNldFZpZXdFdmVudC5FVkVOVF9UWVBFO1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBnZXRQYXlsb2FkKCkge1xyXG4gICAgICAgIGNvbnN0IHBheWxvYWQgPSBzdXBlci5nZXRQYXlsb2FkKCk7XHJcbiAgICAgICAgcGF5bG9hZC5wZGZEYXRhID0gdGhpcy5wZGZEYXRhO1xyXG4gICAgICAgIHBheWxvYWQucGFnZSA9IHRoaXMucGFnZTtcclxuICAgICAgICByZXR1cm4gcGF5bG9hZDtcclxuICAgIH1cclxufVxyXG4iLCIvKiBDb3B5cmlnaHQgMjAyMCBBbmRyZXcgQ3VjY2luZWxsb1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcblxyXG5pbXBvcnQgeyBQREZTZXR0aW5ncyB9IGZyb20gJy4uLy4uL3NldHRpbmdzL1BERlNldHRpbmdzJztcclxuaW1wb3J0IHsgUERGU29ja2V0SGFuZGxlciB9IGZyb20gJy4uL1BERlNvY2tldEhhbmRsZXInO1xyXG5pbXBvcnQgeyBQREZMb2cgfSBmcm9tICcuLi8uLi9sb2cvUERGTG9nJztcclxuXHJcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBQREZTb2NrZXRFdmVudCB7XHJcbiAgICBwdWJsaWMgc3RhdGljIGdldCBFVkVOVF9UWVBFKCkge1xyXG4gICAgICAgIHJldHVybiAnUERGT1VORFJZJztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFRoZSB1c2VyIGlkcyB0aGF0IHNob3VsZCBoYW5kbGUgdGhpcyBldmVudC5cclxuICAgICAqL1xyXG4gICAgcHJvdGVjdGVkIHVzZXJJZHM6IHN0cmluZ1tdfG51bGw7XHJcblxyXG4gICAgcHJvdGVjdGVkIGNvbnN0cnVjdG9yKHVzZXJJZHM6IHN0cmluZ1tdfG51bGwpIHtcclxuICAgICAgICB0aGlzLnVzZXJJZHMgPSB1c2VySWRzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhlIHR5cGUgb2YgdGhpcyBldmVudC5cclxuICAgICAqL1xyXG4gICAgcHVibGljIGFic3RyYWN0IGdldCB0eXBlKCk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgYW55IGRhdGEgdGhhdCB3aWxsIGJlIHNlbnQgd2l0aCB0aGUgZXZlbnQuXHJcbiAgICAgKi9cclxuICAgIHByb3RlY3RlZCBnZXRQYXlsb2FkKCk6IGFueSB7XHJcbiAgICAgICAgcmV0dXJuIHt9O1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBlbWl0KCkge1xyXG4gICAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgICBnYW1lLnNvY2tldC5lbWl0KFBERlNvY2tldEhhbmRsZXIuU09DS0VUX05BTUUsIHtcclxuICAgICAgICAgICAgdHlwZTogdGhpcy50eXBlLFxyXG4gICAgICAgICAgICB1c2VySWRzOiB0aGlzLnVzZXJJZHMsXHJcbiAgICAgICAgICAgIHBheWxvYWQ6IHRoaXMuZ2V0UGF5bG9hZCgpLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbiIsIi8qIENvcHlyaWdodCAyMDIwIEFuZHJldyBDdWNjaW5lbGxvXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFBERlNldHRpbmdzIH0gZnJvbSAnLi4vc2V0dGluZ3MvUERGU2V0dGluZ3MnO1xyXG5pbXBvcnQgeyBQREZFdmVudHMgfSBmcm9tICcuLi9ldmVudHMvUERGRXZlbnRzJztcclxuaW1wb3J0IHsgUERGRGF0YSB9IGZyb20gJy4uL3R5cGVzL1BERkRhdGEnO1xyXG5pbXBvcnQgeyBQREZqc1ZpZXdlciB9IGZyb20gJy4uL3R5cGVzL1BERmpzVmlld2VyJztcclxuaW1wb3J0IHsgUERGTG9nIH0gZnJvbSAnLi4vbG9nL1BERkxvZyc7XHJcbmltcG9ydCB7IFBERlNldFZpZXdFdmVudCB9IGZyb20gJy4uL3NvY2tldC9ldmVudHMvUERGU2V0Vmlld0V2ZW50JztcclxuaW1wb3J0IHsgUERGVXRpbCB9IGZyb20gJy4uL2FwaS9QREZVdGlsJztcclxuaW1wb3J0IHsgUERGanNFdmVudEJ1cyB9IGZyb20gJy4uL3R5cGVzL1BERmpzRXZlbnRCdXMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBERlZpZXdlciBleHRlbmRzIEFwcGxpY2F0aW9uIHtcclxuICAgIHN0YXRpYyBnZXQgZGVmYXVsdE9wdGlvbnMoKSB7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHN1cGVyLmRlZmF1bHRPcHRpb25zO1xyXG4gICAgICAgIG9wdGlvbnMuY2xhc3NlcyA9IFsnYXBwJywgJ3dpbmRvdy1hcHAnLCAncGRmb3VuZHJ5LXZpZXdlciddO1xyXG4gICAgICAgIG9wdGlvbnMudGVtcGxhdGUgPSBgc3lzdGVtcy8ke1BERlNldHRpbmdzLkVYVEVSTkFMX1NZU1RFTV9OQU1FfS9wZGZvdW5kcnktZGlzdC90ZW1wbGF0ZXMvYXBwL3BkZi12aWV3ZXIuaHRtbGA7XHJcbiAgICAgICAgb3B0aW9ucy50aXRsZSA9IGdhbWUuaTE4bi5sb2NhbGl6ZSgnUERGT1VORFJZLlZJRVdFUi5WaWV3UERGJyk7XHJcbiAgICAgICAgb3B0aW9ucy53aWR0aCA9IDguNSAqIDEwMCArIDY0O1xyXG4gICAgICAgIG9wdGlvbnMuaGVpZ2h0ID0gMTEgKiAxMDAgKyA2NDtcclxuICAgICAgICBvcHRpb25zLnJlc2l6YWJsZSA9IHRydWU7XHJcbiAgICAgICAgcmV0dXJuIG9wdGlvbnM7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIF9mcmFtZTogSFRNTElGcmFtZUVsZW1lbnQ7XHJcbiAgICBwcm90ZWN0ZWQgX3ZpZXdlcjogUERGanNWaWV3ZXI7XHJcbiAgICBwcm90ZWN0ZWQgX2V2ZW50QnVzOiBQREZqc0V2ZW50QnVzO1xyXG4gICAgcHJvdGVjdGVkIF9wZGZEYXRhOiBQREZEYXRhO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHBkZkRhdGE/OiBQREZEYXRhLCBvcHRpb25zPzogQXBwbGljYXRpb25PcHRpb25zKSB7XHJcbiAgICAgICAgc3VwZXIob3B0aW9ucyk7XHJcblxyXG4gICAgICAgIGlmIChwZGZEYXRhID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcGRmRGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IGdhbWUuaTE4bi5sb2NhbGl6ZSgnUERGT1VORFJZLlZJRVdFUi5WaWV3UERGJyksXHJcbiAgICAgICAgICAgICAgICBjb2RlOiAnJyxcclxuICAgICAgICAgICAgICAgIG9mZnNldDogMCxcclxuICAgICAgICAgICAgICAgIHVybDogJycsXHJcbiAgICAgICAgICAgICAgICBjYWNoZTogZmFsc2UsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9wZGZEYXRhID0gcGRmRGF0YTtcclxuICAgIH1cclxuXHJcbiAgICAvLyA8ZWRpdG9yLWZvbGQgZGVzYz1cIkdldHRlcnMgJiBTZXR0ZXJzXCI+XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGEgY29weSBvZiB0aGUgUERGRGF0YSB0aGlzIHZpZXdlciBpcyB1c2luZy5cclxuICAgICAqIENoYW5nZXMgdG8gdGhpcyBkYXRhIHdpbGwgbm90IHJlZmxlY3QgaW4gdGhlIHZpZXdlci5cclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldCBwZGZEYXRhKCkge1xyXG4gICAgICAgIHJldHVybiBkdXBsaWNhdGUodGhpcy5fcGRmRGF0YSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldCBwYWdlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl92aWV3ZXIucGFnZTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc2V0IHBhZ2UodmFsdWU6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMuX3ZpZXdlci5wYWdlID0gdmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cclxuXHJcbiAgICAvLyA8ZWRpdG9yLWZvbGQgZGVzYz1cIkZvdW5kcnkgT3ZlcnJpZGVzXCI+XHJcblxyXG4gICAgZ2V0IHRpdGxlKCk6IHN0cmluZyB7XHJcbiAgICAgICAgbGV0IHRpdGxlID0gdGhpcy5fcGRmRGF0YS5uYW1lO1xyXG4gICAgICAgIGlmICh0aGlzLl9wZGZEYXRhLmNvZGUgIT09ICcnKSB7XHJcbiAgICAgICAgICAgIHRpdGxlID0gYCR7dGl0bGV9ICgke3RoaXMuX3BkZkRhdGEuY29kZX0pYDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRpdGxlO1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBfZ2V0SGVhZGVyQnV0dG9ucygpOiBhbnlbXSB7XHJcbiAgICAgICAgY29uc3QgYnV0dG9ucyA9IHN1cGVyLl9nZXRIZWFkZXJCdXR0b25zKCk7XHJcbiAgICAgICAgLy9UT0RPOiBTdGFuZGFyZGl6ZSB0aGlzIHRvIGZ1bmN0aW9uIHcvIHRoZSBJdGVtIHNoZWV0IG9uZVxyXG4gICAgICAgIGJ1dHRvbnMudW5zaGlmdCh7XHJcbiAgICAgICAgICAgIGNsYXNzOiAncGRmLXNoZWV0LWdpdGh1YicsXHJcbiAgICAgICAgICAgIGljb246ICdmYXMgZmEtZXh0ZXJuYWwtbGluay1hbHQnLFxyXG4gICAgICAgICAgICBsYWJlbDogJ1BERm91bmRyeScsXHJcbiAgICAgICAgICAgIG9uY2xpY2s6ICgpID0+IHdpbmRvdy5vcGVuKCdodHRwczovL2dpdGh1Yi5jb20vRGpwaG9lbml4NzE5L1BERm91bmRyeScsICdfYmxhbmsnKSxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKGdhbWUudXNlci5pc0dNKSB7XHJcbiAgICAgICAgICAgIC8vVE9ETzogU2hvdyB0byBpbmRpdmlkdWFsIHBsYXllcnMuXHJcbiAgICAgICAgICAgIGJ1dHRvbnMudW5zaGlmdCh7XHJcbiAgICAgICAgICAgICAgICBjbGFzczogJ3BkZi1zaGVldC1zaG93LXBsYXllcnMnLFxyXG4gICAgICAgICAgICAgICAgaWNvbjogJ2ZhcyBmYS1leWUnLFxyXG4gICAgICAgICAgICAgICAgbGFiZWw6ICdTaG93IHRvIFBsYXllcnMnLFxyXG4gICAgICAgICAgICAgICAgb25jbGljazogKCkgPT4gdGhpcy5zaG93VG9QbGF5ZXJzKCksXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGJ1dHRvbnMudW5zaGlmdCh7XHJcbiAgICAgICAgICAgICAgICBjbGFzczogJ3BkZi1zaGVldC1zaG93LWdtJyxcclxuICAgICAgICAgICAgICAgIGljb246ICdmYXMgZmEtZXllJyxcclxuICAgICAgICAgICAgICAgIGxhYmVsOiAnU2hvdyB0byBHTScsXHJcbiAgICAgICAgICAgICAgICBvbmNsaWNrOiAoKSA9PiB0aGlzLnNob3dUb0dNKCksXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGJ1dHRvbnM7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RGF0YShvcHRpb25zPzogYW55KTogYW55IHwgUHJvbWlzZTxhbnk+IHtcclxuICAgICAgICBjb25zdCBkYXRhID0gc3VwZXIuZ2V0RGF0YShvcHRpb25zKTtcclxuICAgICAgICBkYXRhLnN5c3RlbU5hbWUgPSBQREZTZXR0aW5ncy5FWFRFUk5BTF9TWVNURU1fTkFNRTtcclxuICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgYXN5bmMgYWN0aXZhdGVMaXN0ZW5lcnMoaHRtbDogSlF1ZXJ5PEhUTUxFbGVtZW50Pik6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICAgIHN1cGVyLmFjdGl2YXRlTGlzdGVuZXJzKGh0bWwpO1xyXG5cclxuICAgICAgICB0aGlzLl9mcmFtZSA9IGh0bWwucGFyZW50KCkuZmluZCgnaWZyYW1lLnBkZlZpZXdlcicpLmdldCgwKSBhcyBIVE1MSUZyYW1lRWxlbWVudDtcclxuICAgICAgICB0aGlzLmdldFZpZXdlcigpLnRoZW4oYXN5bmMgKHZpZXdlcikgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl92aWV3ZXIgPSB2aWV3ZXI7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmdldEV2ZW50QnVzKCkudGhlbigoZXZlbnRCdXMpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2V2ZW50QnVzID0gZXZlbnRCdXM7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgbGlzdGVuZXJzID0gZXZlbnRCdXMuX2xpc3RlbmVycztcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZXZlbnROYW1lIG9mIE9iamVjdC5rZXlzKGxpc3RlbmVycykpIHtcclxuICAgICAgICAgICAgICAgICAgICBldmVudEJ1cy5vbihldmVudE5hbWUsICguLi5hcmdzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nRXZlbnQoZXZlbnROYW1lLCBhcmdzKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBGaXJlIHRoZSB2aWV3ZXJSZWFkeSBldmVudCBzbyB0aGUgdmlld2VyIG1heSBiZSB1c2VkIGV4dGVybmFsbHlcclxuICAgICAgICAgICAgICAgIFBERkV2ZW50cy5maXJlKCd2aWV3ZXJSZWFkeScsIHRoaXMpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGxvZ0V2ZW50KGtleTogc3RyaW5nLCAuLi5hcmdzKSB7XHJcbiAgICAgICAgY29uc29sZS5kZWJ1ZyhrZXkpO1xyXG4gICAgICAgIGNvbnNvbGUuZGVidWcoYXJncyk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgY2xvc2UoKTogUHJvbWlzZTxhbnk+IHtcclxuICAgICAgICBQREZFdmVudHMuZmlyZSgndmlld2VyQ2xvc2UnLCB0aGlzKTtcclxuICAgICAgICByZXR1cm4gc3VwZXIuY2xvc2UoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyA8L2VkaXRvci1mb2xkPlxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU2hvdyB0aGUgY3VycmVudCBwYWdlIHRvIEdNcy5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBzaG93VG9HTSgpIHtcclxuICAgICAgICBjb25zdCBwZGZEYXRhID0gdGhpcy5wZGZEYXRhO1xyXG4gICAgICAgIHBkZkRhdGEub2Zmc2V0ID0gMDtcclxuXHJcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxyXG4gICAgICAgIGNvbnN0IGlkcyA9IFBERlV0aWwuZ2V0VXNlcklkc09mUm9sZShVU0VSX1JPTEVTLkdBTUVNQVNURVIpO1xyXG4gICAgICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2U7XHJcblxyXG4gICAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IFBERlNldFZpZXdFdmVudChpZHMsIHBkZkRhdGEsIHBhZ2UpO1xyXG4gICAgICAgIGV2ZW50LmVtaXQoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNob3cgdGhlIGN1cnJlbnQgcGFnZSB0byBwbGF5ZXJzLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHNob3dUb1BsYXllcnMoKSB7XHJcbiAgICAgICAgY29uc3QgcGRmRGF0YSA9IHRoaXMucGRmRGF0YTtcclxuICAgICAgICBwZGZEYXRhLm9mZnNldCA9IDA7XHJcblxyXG4gICAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgICBjb25zdCBpZHMgPSBQREZVdGlsLmdldFVzZXJJZHNBdE1vc3RSb2xlKFVTRVJfUk9MRVMuQVNTSVNUQU5UKTtcclxuICAgICAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlO1xyXG5cclxuICAgICAgICBjb25zdCBldmVudCA9IG5ldyBQREZTZXRWaWV3RXZlbnQoaWRzLCBwZGZEYXRhLCBwYWdlKTtcclxuICAgICAgICBldmVudC5lbWl0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBXYWl0IGZvciB0aGUgaW50ZXJuYWwgUERGanMgdmlld2VyIHRvIGJlIHJlYWR5IGFuZCB1c2FibGUuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZ2V0Vmlld2VyKCk6IFByb21pc2U8UERGanNWaWV3ZXI+IHtcclxuICAgICAgICBpZiAodGhpcy5fdmlld2VyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5fdmlld2VyKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZTxhbnk+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgbGV0IHRpbWVvdXQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHJldHVybk9yV2FpdCA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIElmIG91ciB3aW5kb3cgaGFzIGZpbmlzaGVkIGluaXRpYWxpemluZy4uLlxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2ZyYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgUERGanMgaGFzIGZpbmlzaGVkIGluaXRpYWxpemluZy4uLlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9mcmFtZS5jb250ZW50V2luZG93ICYmIHRoaXMuX2ZyYW1lLmNvbnRlbnRXaW5kb3dbJ1BERlZpZXdlckFwcGxpY2F0aW9uJ10pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgdmlld2VyID0gdGhpcy5fZnJhbWUuY29udGVudFdpbmRvd1snUERGVmlld2VyQXBwbGljYXRpb24nXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh2aWV3ZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIElmIGFueSBpZnMgZmFsbCB0aHJvdWdoLCB0cnkgYWdhaW4gaW4gYSBmZXcgbXNcclxuICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KHJldHVybk9yV2FpdCwgNSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHJldHVybk9yV2FpdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogV2FpdCBmb3IgdGhlIGludGVybmFsIFBERmpzIGV2ZW50QnVzIHRvIGJlIHJlYWR5IGFuZCB1c2FibGUuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZ2V0RXZlbnRCdXMoKTogUHJvbWlzZTxQREZqc0V2ZW50QnVzPiB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2V2ZW50QnVzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5fZXZlbnRCdXMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPGFueT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmdldFZpZXdlcigpLnRoZW4oKHZpZXdlcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IHRpbWVvdXQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByZXR1cm5PcldhaXQgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdlci5ldmVudEJ1cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHZpZXdlci5ldmVudEJ1cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQocmV0dXJuT3JXYWl0LCA1KTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICByZXR1cm5PcldhaXQoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBGaW5pc2ggdGhlIGRvd25sb2FkIGFuZCByZXR1cm4gdGhlIGJ5dGUgYXJyYXkgZm9yIHRoZSBmaWxlLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZG93bmxvYWQoKTogUHJvbWlzZTxVaW50OEFycmF5PiB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPFVpbnQ4QXJyYXk+KGFzeW5jIChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgdmlld2VyID0gYXdhaXQgdGhpcy5nZXRWaWV3ZXIoKTtcclxuICAgICAgICAgICAgbGV0IHRpbWVvdXQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHJldHVybk9yV2FpdCA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh2aWV3ZXIuZG93bmxvYWRDb21wbGV0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUodmlld2VyLnBkZkRvY3VtZW50LmdldERhdGEoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KHJldHVybk9yV2FpdCwgNTApO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICByZXR1cm5PcldhaXQoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgYXN5bmMgb3BlbihwZGZTb3VyY2U6IHN0cmluZyB8IFVpbnQ4QXJyYXksIHBhZ2U/OiBudW1iZXIpIHtcclxuICAgICAgICBjb25zdCBwZGZqc1ZpZXdlciA9IGF3YWl0IHRoaXMuZ2V0Vmlld2VyKCk7XHJcblxyXG4gICAgICAgIGlmIChwYWdlKSB7XHJcbiAgICAgICAgICAgIHBkZmpzVmlld2VyLmluaXRpYWxCb29rbWFyayA9IGBwYWdlPSR7cGFnZX1gO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYXdhaXQgcGRmanNWaWV3ZXIub3BlbihwZGZTb3VyY2UpO1xyXG4gICAgfVxyXG59XHJcbiJdfQ=="}